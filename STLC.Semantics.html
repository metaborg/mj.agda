<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>STLC.Semantics</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="STLC.Semantics.html" class="Module">STLC.Semantics</a> <a id="23" class="Keyword">where</a>

<a id="30" class="Comment">-- This file contains the definitional interpreter for STLC described</a>
<a id="100" class="Comment">-- in Section 2 of the paper.</a>

<a id="131" class="Keyword">open</a> <a id="136" class="Keyword">import</a> <a id="143" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="Data.Integer.html" class="Module">Data.Integer</a>
<a id="177" class="Keyword">open</a> <a id="182" class="Keyword">import</a> <a id="189" href="Data.List.Most.html" class="Module">Data.List.Most</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="227" class="Keyword">hiding</a> <a id="234" class="Symbol">(</a><a id="235" href="Data.Maybe.Base.html#All" class="Datatype">All</a><a id="238" class="Symbol">)</a>


<a id="242" class="Comment">------------</a>
<a id="255" class="Comment">-- SYNTAX --</a>
<a id="268" class="Comment">------------</a>

<a id="282" class="Comment">-- These definitions correspond to Section 2.1, except we have</a>
<a id="345" class="Comment">-- included numbers (integers) and integer operations in the language.</a>

<a id="417" class="Keyword">data</a> <a id="Ty" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a> <a id="425" class="Symbol">:</a> <a id="427" class="PrimitiveType">Set</a> <a id="431" class="Keyword">where</a>
  <a id="Ty.unit" href="STLC.Semantics.html#Ty.unit" class="InductiveConstructor">unit</a> <a id="444" class="Symbol">:</a> <a id="446" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a>
  <a id="Ty._⇒_" href="STLC.Semantics.html#Ty._%E2%87%92_" class="InductiveConstructor Operator">_⇒_</a>  <a id="456" class="Symbol">:</a> <a id="458" class="Symbol">(</a><a id="459" href="STLC.Semantics.html#459" class="Bound">a</a> <a id="461" href="STLC.Semantics.html#461" class="Bound">b</a> <a id="463" class="Symbol">:</a> <a id="465" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a><a id="467" class="Symbol">)</a> <a id="469" class="Symbol">→</a> <a id="471" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a>
  <a id="Ty.int" href="STLC.Semantics.html#Ty.int" class="InductiveConstructor">int</a>  <a id="481" class="Symbol">:</a> <a id="483" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a>

<a id="Ctx" href="STLC.Semantics.html#Ctx" class="Function">Ctx</a> <a id="491" class="Symbol">=</a> <a id="493" href="Agda.Builtin.List.html#List" class="Datatype">List</a> <a id="498" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a>

<a id="502" class="Comment">-- Below, `Expr` uses `_∈_` from `Relation.Binary` in the Agda</a>
<a id="565" class="Comment">-- Standard Library to represent typed de Bruijn indices which witness</a>
<a id="636" class="Comment">-- the existence of an entry in the type context.</a>

<a id="687" class="Keyword">data</a> <a id="Expr" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="697" class="Symbol">(</a><a id="698" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="700" class="Symbol">:</a> <a id="702" href="STLC.Semantics.html#Ctx" class="Function">Ctx</a><a id="705" class="Symbol">)</a> <a id="707" class="Symbol">:</a> <a id="709" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a> <a id="712" class="Symbol">→</a> <a id="714" class="PrimitiveType">Set</a> <a id="718" class="Keyword">where</a>
  <a id="Expr.unit" href="STLC.Semantics.html#Expr.unit" class="InductiveConstructor">unit</a>  <a id="732" class="Symbol">:</a> <a id="734" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="739" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="741" href="STLC.Semantics.html#Ty.unit" class="InductiveConstructor">unit</a>
  <a id="Expr.var" href="STLC.Semantics.html#Expr.var" class="InductiveConstructor">var</a>   <a id="754" class="Symbol">:</a> <a id="756" class="Symbol">∀</a> <a id="758" class="Symbol">{</a><a id="759" href="STLC.Semantics.html#759" class="Bound">t</a><a id="760" class="Symbol">}</a> <a id="762" class="Symbol">→</a> <a id="764" href="STLC.Semantics.html#759" class="Bound">t</a> <a id="766" href="Data.List.Any.Membership.html#Propositional.M._%E2%88%88_" class="Function Operator">∈</a> <a id="768" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="770" class="Symbol">→</a> <a id="772" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="777" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="779" href="STLC.Semantics.html#759" class="Bound">t</a>
  <a id="Expr.ƛ" href="STLC.Semantics.html#Expr.%C6%9B" class="InductiveConstructor">ƛ</a>     <a id="789" class="Symbol">:</a> <a id="791" class="Symbol">∀</a> <a id="793" class="Symbol">{</a><a id="794" href="STLC.Semantics.html#794" class="Bound">a</a> <a id="796" href="STLC.Semantics.html#796" class="Bound">b</a><a id="797" class="Symbol">}</a> <a id="799" class="Symbol">→</a> <a id="801" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="806" class="Symbol">(</a><a id="807" href="STLC.Semantics.html#794" class="Bound">a</a> <a id="809" href="Agda.Builtin.List.html#List._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="811" href="STLC.Semantics.html#698" class="Bound">Γ</a><a id="812" class="Symbol">)</a> <a id="814" href="STLC.Semantics.html#796" class="Bound">b</a> <a id="816" class="Symbol">→</a> <a id="818" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="823" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="825" class="Symbol">(</a><a id="826" href="STLC.Semantics.html#794" class="Bound">a</a> <a id="828" href="STLC.Semantics.html#Ty._%E2%87%92_" class="InductiveConstructor Operator">⇒</a> <a id="830" href="STLC.Semantics.html#796" class="Bound">b</a><a id="831" class="Symbol">)</a>
  <a id="Expr._·_" href="STLC.Semantics.html#Expr._%C2%B7_" class="InductiveConstructor Operator">_·_</a>   <a id="841" class="Symbol">:</a> <a id="843" class="Symbol">∀</a> <a id="845" class="Symbol">{</a><a id="846" href="STLC.Semantics.html#846" class="Bound">a</a> <a id="848" href="STLC.Semantics.html#848" class="Bound">b</a><a id="849" class="Symbol">}</a> <a id="851" class="Symbol">→</a> <a id="853" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="858" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="860" class="Symbol">(</a><a id="861" href="STLC.Semantics.html#846" class="Bound">a</a> <a id="863" href="STLC.Semantics.html#Ty._%E2%87%92_" class="InductiveConstructor Operator">⇒</a> <a id="865" href="STLC.Semantics.html#848" class="Bound">b</a><a id="866" class="Symbol">)</a> <a id="868" class="Symbol">→</a> <a id="870" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="875" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="877" href="STLC.Semantics.html#846" class="Bound">a</a> <a id="879" class="Symbol">→</a> <a id="881" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="886" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="888" href="STLC.Semantics.html#848" class="Bound">b</a>
  <a id="Expr.num" href="STLC.Semantics.html#Expr.num" class="InductiveConstructor">num</a>   <a id="898" class="Symbol">:</a> <a id="900" href="Agda.Builtin.Int.html#%E2%84%A4" class="Datatype">ℤ</a> <a id="902" class="Symbol">→</a> <a id="904" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="909" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="911" href="STLC.Semantics.html#Ty.int" class="InductiveConstructor">int</a>
  <a id="Expr.iop" href="STLC.Semantics.html#Expr.iop" class="InductiveConstructor">iop</a>   <a id="923" class="Symbol">:</a> <a id="925" class="Symbol">(</a><a id="926" href="Agda.Builtin.Int.html#%E2%84%A4" class="Datatype">ℤ</a> <a id="928" class="Symbol">→</a> <a id="930" href="Agda.Builtin.Int.html#%E2%84%A4" class="Datatype">ℤ</a> <a id="932" class="Symbol">→</a> <a id="934" href="Agda.Builtin.Int.html#%E2%84%A4" class="Datatype">ℤ</a><a id="935" class="Symbol">)</a> <a id="937" class="Symbol">→</a> <a id="939" class="Symbol">(</a><a id="940" href="STLC.Semantics.html#940" class="Bound">l</a> <a id="942" href="STLC.Semantics.html#942" class="Bound">r</a> <a id="944" class="Symbol">:</a> <a id="946" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="951" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="953" href="STLC.Semantics.html#Ty.int" class="InductiveConstructor">int</a><a id="956" class="Symbol">)</a> <a id="958" class="Symbol">→</a> <a id="960" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="965" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="967" href="STLC.Semantics.html#Ty.int" class="InductiveConstructor">int</a>


<a id="973" class="Comment">-----------------------------</a>
<a id="1003" class="Comment">-- VALUES AND ENVIRONMENTS --</a>
<a id="1033" class="Comment">-----------------------------</a>

<a id="1064" class="Comment">-- These definitions correspond to Section 2.2.</a>
<a id="1112" class="Comment">--</a>
<a id="1115" class="Comment">-- Note that the `All` type described in Section 2.2 of the paper (for</a>
<a id="1186" class="Comment">-- simplicity) does not mention universe levels, whereas the `All`</a>
<a id="1253" class="Comment">-- definition below refers to `Data.List.All` in the Agda Standard</a>
<a id="1320" class="Comment">-- Library which is defined in a universe polymorphic manner.</a>

<a id="1383" class="Keyword">mutual</a>
  <a id="1392" class="Keyword">data</a> <a id="Val" href="STLC.Semantics.html#Val" class="Datatype">Val</a> <a id="1401" class="Symbol">:</a> <a id="1403" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a> <a id="1406" class="Symbol">→</a> <a id="1408" class="PrimitiveType">Set</a> <a id="1412" class="Keyword">where</a>
    <a id="Val.unit" href="STLC.Semantics.html#Val.unit" class="InductiveConstructor">unit</a>  <a id="1428" class="Symbol">:</a> <a id="1430" href="STLC.Semantics.html#Val" class="Datatype">Val</a> <a id="1434" href="STLC.Semantics.html#Ty.unit" class="InductiveConstructor">unit</a>
    <a id="Val.⟨_,_⟩" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟨_,_⟩</a> <a id="1449" class="Symbol">:</a> <a id="1451" class="Symbol">∀</a> <a id="1453" class="Symbol">{</a><a id="1454" href="STLC.Semantics.html#1454" class="Bound">Γ</a> <a id="1456" href="STLC.Semantics.html#1456" class="Bound">a</a> <a id="1458" href="STLC.Semantics.html#1458" class="Bound">b</a><a id="1459" class="Symbol">}</a> <a id="1461" class="Symbol">→</a> <a id="1463" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="1468" class="Symbol">(</a><a id="1469" href="STLC.Semantics.html#1456" class="Bound">a</a> <a id="1471" href="Agda.Builtin.List.html#List._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="1473" href="STLC.Semantics.html#1454" class="Bound">Γ</a><a id="1474" class="Symbol">)</a> <a id="1476" href="STLC.Semantics.html#1458" class="Bound">b</a> <a id="1478" class="Symbol">→</a> <a id="1480" href="STLC.Semantics.html#Env" class="Function">Env</a> <a id="1484" href="STLC.Semantics.html#1454" class="Bound">Γ</a> <a id="1486" class="Symbol">→</a> <a id="1488" href="STLC.Semantics.html#Val" class="Datatype">Val</a> <a id="1492" class="Symbol">(</a><a id="1493" href="STLC.Semantics.html#1456" class="Bound">a</a> <a id="1495" href="STLC.Semantics.html#Ty._%E2%87%92_" class="InductiveConstructor Operator">⇒</a> <a id="1497" href="STLC.Semantics.html#1458" class="Bound">b</a><a id="1498" class="Symbol">)</a>
    <a id="Val.num" href="STLC.Semantics.html#Val.num" class="InductiveConstructor">num</a>   <a id="1510" class="Symbol">:</a> <a id="1512" href="Agda.Builtin.Int.html#%E2%84%A4" class="Datatype">ℤ</a> <a id="1514" class="Symbol">→</a> <a id="1516" href="STLC.Semantics.html#Val" class="Datatype">Val</a> <a id="1520" href="STLC.Semantics.html#Ty.int" class="InductiveConstructor">int</a>

  <a id="Env" href="STLC.Semantics.html#Env" class="Function">Env</a> <a id="1531" class="Symbol">:</a> <a id="1533" href="STLC.Semantics.html#Ctx" class="Function">Ctx</a> <a id="1537" class="Symbol">→</a> <a id="1539" class="PrimitiveType">Set</a>
  <a id="1545" href="STLC.Semantics.html#Env" class="Function">Env</a> <a id="1549" href="STLC.Semantics.html#1549" class="Bound">Γ</a> <a id="1551" class="Symbol">=</a> <a id="1553" href="Data.List.All.html#All" class="Datatype">All</a> <a id="1557" href="STLC.Semantics.html#Val" class="Datatype">Val</a> <a id="1561" href="STLC.Semantics.html#1549" class="Bound">Γ</a>

<a id="1564" class="Comment">-- The `lookup` function described in Section 2.2 of the paper is also</a>
<a id="1635" class="Comment">-- defined in `Data.List.All` in the Agda Standard Library.</a>


<a id="1697" class="Comment">-----------</a>
<a id="1709" class="Comment">-- MONAD --</a>
<a id="1721" class="Comment">-----------</a>

<a id="1734" class="Comment">-- These definitions correspond to Section 2.3.</a>

<a id="M" href="STLC.Semantics.html#M" class="Function">M</a> <a id="1785" class="Symbol">:</a> <a id="1787" href="STLC.Semantics.html#Ctx" class="Function">Ctx</a> <a id="1791" class="Symbol">→</a> <a id="1793" class="PrimitiveType">Set</a> <a id="1797" class="Symbol">→</a> <a id="1799" class="PrimitiveType">Set</a>
<a id="1803" href="STLC.Semantics.html#M" class="Function">M</a> <a id="1805" href="STLC.Semantics.html#1805" class="Bound">Γ</a> <a id="1807" href="STLC.Semantics.html#1807" class="Bound">a</a>  <a id="1810" class="Symbol">=</a>  <a id="1813" href="STLC.Semantics.html#Env" class="Function">Env</a> <a id="1817" href="STLC.Semantics.html#1805" class="Bound">Γ</a> <a id="1819" class="Symbol">→</a> <a id="1821" href="Data.Maybe.Base.html#Maybe" class="Datatype">Maybe</a> <a id="1827" href="STLC.Semantics.html#1807" class="Bound">a</a>

<a id="_&gt;&gt;=_" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">_&gt;&gt;=_</a>    <a id="1839" class="Symbol">:</a> <a id="1841" class="Symbol">∀</a> <a id="1843" class="Symbol">{</a><a id="1844" href="STLC.Semantics.html#1844" class="Bound">Γ</a> <a id="1846" href="STLC.Semantics.html#1846" class="Bound">a</a> <a id="1848" href="STLC.Semantics.html#1848" class="Bound">b</a><a id="1849" class="Symbol">}</a> <a id="1851" class="Symbol">→</a> <a id="1853" href="STLC.Semantics.html#M" class="Function">M</a> <a id="1855" href="STLC.Semantics.html#1844" class="Bound">Γ</a> <a id="1857" href="STLC.Semantics.html#1846" class="Bound">a</a> <a id="1859" class="Symbol">→</a> <a id="1861" class="Symbol">(</a><a id="1862" href="STLC.Semantics.html#1846" class="Bound">a</a> <a id="1864" class="Symbol">→</a> <a id="1866" href="STLC.Semantics.html#M" class="Function">M</a> <a id="1868" href="STLC.Semantics.html#1844" class="Bound">Γ</a> <a id="1870" href="STLC.Semantics.html#1848" class="Bound">b</a><a id="1871" class="Symbol">)</a> <a id="1873" class="Symbol">→</a> <a id="1875" href="STLC.Semantics.html#M" class="Function">M</a> <a id="1877" href="STLC.Semantics.html#1844" class="Bound">Γ</a> <a id="1879" href="STLC.Semantics.html#1848" class="Bound">b</a>
<a id="1881" class="Symbol">(</a><a id="1882" href="STLC.Semantics.html#1882" class="Bound">f</a> <a id="1884" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="1888" href="STLC.Semantics.html#1888" class="Bound">c</a><a id="1889" class="Symbol">)</a> <a id="1891" href="STLC.Semantics.html#1891" class="Bound">E</a> <a id="1893" class="Keyword">with</a> <a id="1898" class="Symbol">(</a><a id="1899" href="STLC.Semantics.html#1882" class="Bound">f</a> <a id="1901" href="STLC.Semantics.html#1891" class="Bound">E</a><a id="1902" class="Symbol">)</a>
<a id="1904" class="Symbol">...</a> <a id="1908" class="Symbol">|</a> <a id="1910" href="Data.Maybe.Base.html#Maybe.just" class="InductiveConstructor">just</a> <a id="1915" href="STLC.Semantics.html#1915" class="Bound">x</a> <a id="1917" class="Symbol">=</a> <a id="1919" class="Bound">c</a> <a id="1921" href="STLC.Semantics.html#1915" class="Bound">x</a> <a id="1923" class="Bound">E</a>
<a id="1925" class="Symbol">...</a> <a id="1929" class="Symbol">|</a> <a id="1931" href="Data.Maybe.Base.html#Maybe.nothing" class="InductiveConstructor">nothing</a> <a id="1939" class="Symbol">=</a> <a id="1941" href="Data.Maybe.Base.html#Maybe.nothing" class="InductiveConstructor">nothing</a>

<a id="return" href="STLC.Semantics.html#return" class="Function">return</a>   <a id="1959" class="Symbol">:</a> <a id="1961" class="Symbol">∀</a> <a id="1963" class="Symbol">{</a><a id="1964" href="STLC.Semantics.html#1964" class="Bound">Γ</a> <a id="1966" href="STLC.Semantics.html#1966" class="Bound">a</a><a id="1967" class="Symbol">}</a> <a id="1969" class="Symbol">→</a> <a id="1971" href="STLC.Semantics.html#1966" class="Bound">a</a> <a id="1973" class="Symbol">→</a> <a id="1975" href="STLC.Semantics.html#M" class="Function">M</a> <a id="1977" href="STLC.Semantics.html#1964" class="Bound">Γ</a> <a id="1979" href="STLC.Semantics.html#1966" class="Bound">a</a>
<a id="1981" href="STLC.Semantics.html#return" class="Function">return</a> <a id="1988" href="STLC.Semantics.html#1988" class="Bound">x</a> <a id="1990" href="STLC.Semantics.html#1990" class="Bound">E</a> <a id="1992" class="Symbol">=</a> <a id="1994" href="Data.Maybe.Base.html#Maybe.just" class="InductiveConstructor">just</a> <a id="1999" href="STLC.Semantics.html#1988" class="Bound">x</a>

<a id="getEnv" href="STLC.Semantics.html#getEnv" class="Function">getEnv</a>   <a id="2011" class="Symbol">:</a> <a id="2013" class="Symbol">∀</a> <a id="2015" class="Symbol">{</a><a id="2016" href="STLC.Semantics.html#2016" class="Bound">Γ</a><a id="2017" class="Symbol">}</a> <a id="2019" class="Symbol">→</a> <a id="2021" href="STLC.Semantics.html#M" class="Function">M</a> <a id="2023" href="STLC.Semantics.html#2016" class="Bound">Γ</a> <a id="2025" class="Symbol">(</a><a id="2026" href="STLC.Semantics.html#Env" class="Function">Env</a> <a id="2030" href="STLC.Semantics.html#2016" class="Bound">Γ</a><a id="2031" class="Symbol">)</a>
<a id="2033" href="STLC.Semantics.html#getEnv" class="Function">getEnv</a> <a id="2040" href="STLC.Semantics.html#2040" class="Bound">E</a> <a id="2042" class="Symbol">=</a> <a id="2044" href="STLC.Semantics.html#return" class="Function">return</a> <a id="2051" href="STLC.Semantics.html#2040" class="Bound">E</a> <a id="2053" href="STLC.Semantics.html#2040" class="Bound">E</a>

<a id="usingEnv" href="STLC.Semantics.html#usingEnv" class="Function">usingEnv</a> <a id="2065" class="Symbol">:</a> <a id="2067" class="Symbol">∀</a> <a id="2069" class="Symbol">{</a><a id="2070" href="STLC.Semantics.html#2070" class="Bound">Γ</a> <a id="2072" href="STLC.Semantics.html#2072" class="Bound">Γ&#39;</a> <a id="2075" href="STLC.Semantics.html#2075" class="Bound">a</a><a id="2076" class="Symbol">}</a> <a id="2078" class="Symbol">→</a> <a id="2080" href="STLC.Semantics.html#Env" class="Function">Env</a> <a id="2084" href="STLC.Semantics.html#2070" class="Bound">Γ</a> <a id="2086" class="Symbol">→</a> <a id="2088" href="STLC.Semantics.html#M" class="Function">M</a> <a id="2090" href="STLC.Semantics.html#2070" class="Bound">Γ</a> <a id="2092" href="STLC.Semantics.html#2075" class="Bound">a</a> <a id="2094" class="Symbol">→</a> <a id="2096" href="STLC.Semantics.html#M" class="Function">M</a> <a id="2098" href="STLC.Semantics.html#2072" class="Bound">Γ&#39;</a> <a id="2101" href="STLC.Semantics.html#2075" class="Bound">a</a>
<a id="2103" href="STLC.Semantics.html#usingEnv" class="Function">usingEnv</a> <a id="2112" href="STLC.Semantics.html#2112" class="Bound">E</a> <a id="2114" href="STLC.Semantics.html#2114" class="Bound">f</a> <a id="2116" class="Symbol">_</a> <a id="2118" class="Symbol">=</a> <a id="2120" href="STLC.Semantics.html#2114" class="Bound">f</a> <a id="2122" href="STLC.Semantics.html#2112" class="Bound">E</a>

<a id="timeout" href="STLC.Semantics.html#timeout" class="Function">timeout</a>  <a id="2134" class="Symbol">:</a> <a id="2136" class="Symbol">∀</a> <a id="2138" class="Symbol">{</a><a id="2139" href="STLC.Semantics.html#2139" class="Bound">Γ</a> <a id="2141" href="STLC.Semantics.html#2141" class="Bound">a</a><a id="2142" class="Symbol">}</a> <a id="2144" class="Symbol">→</a> <a id="2146" href="STLC.Semantics.html#M" class="Function">M</a> <a id="2148" href="STLC.Semantics.html#2139" class="Bound">Γ</a> <a id="2150" href="STLC.Semantics.html#2141" class="Bound">a</a>
<a id="2152" href="STLC.Semantics.html#timeout" class="Function">timeout</a> <a id="2160" class="Symbol">=</a> <a id="2162" class="Symbol">λ</a> <a id="2164" href="STLC.Semantics.html#2164" class="Bound">_</a> <a id="2166" class="Symbol">→</a> <a id="2168" href="Data.Maybe.Base.html#Maybe.nothing" class="InductiveConstructor">nothing</a>


<a id="2178" class="Comment">-----------------</a>
<a id="2196" class="Comment">-- INTERPRETER --</a>
<a id="2214" class="Comment">-----------------</a>

<a id="2233" class="Comment">-- These definitions correspond to Section 2.4.</a>

<a id="eval" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2287" class="Symbol">:</a> <a id="2289" href="Agda.Builtin.Nat.html#%E2%84%95" class="Datatype">ℕ</a> <a id="2291" class="Symbol">→</a> <a id="2293" class="Symbol">∀</a> <a id="2295" class="Symbol">{</a><a id="2296" href="STLC.Semantics.html#2296" class="Bound">Γ</a> <a id="2298" href="STLC.Semantics.html#2298" class="Bound">t</a><a id="2299" class="Symbol">}</a> <a id="2301" class="Symbol">→</a> <a id="2303" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="2308" href="STLC.Semantics.html#2296" class="Bound">Γ</a> <a id="2310" href="STLC.Semantics.html#2298" class="Bound">t</a> <a id="2312" class="Symbol">→</a> <a id="2314" href="STLC.Semantics.html#M" class="Function">M</a> <a id="2316" href="STLC.Semantics.html#2296" class="Bound">Γ</a> <a id="2318" class="Symbol">(</a><a id="2319" href="STLC.Semantics.html#Val" class="Datatype">Val</a> <a id="2323" href="STLC.Semantics.html#2298" class="Bound">t</a><a id="2324" class="Symbol">)</a>
<a id="2326" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2331" href="Agda.Builtin.Nat.html#Nat.zero" class="InductiveConstructor">zero</a>     <a id="2340" class="Symbol">_</a>           <a id="2352" class="Symbol">=</a>
  <a id="2356" href="STLC.Semantics.html#timeout" class="Function">timeout</a>
<a id="2364" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2369" class="Symbol">(</a><a id="2370" href="Agda.Builtin.Nat.html#Nat.suc" class="InductiveConstructor">suc</a> <a id="2374" href="STLC.Semantics.html#2374" class="Bound">k</a><a id="2375" class="Symbol">)</a>  <a id="2378" href="STLC.Semantics.html#Expr.unit" class="InductiveConstructor">unit</a>        <a id="2390" class="Symbol">=</a>
  <a id="2394" href="STLC.Semantics.html#return" class="Function">return</a> <a id="2401" href="STLC.Semantics.html#Val.unit" class="InductiveConstructor">unit</a>
<a id="2406" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2411" class="Symbol">(</a><a id="2412" href="Agda.Builtin.Nat.html#Nat.suc" class="InductiveConstructor">suc</a> <a id="2416" href="STLC.Semantics.html#2416" class="Bound">k</a><a id="2417" class="Symbol">)</a>  <a id="2420" class="Symbol">(</a><a id="2421" href="STLC.Semantics.html#Expr.var" class="InductiveConstructor">var</a> <a id="2425" href="STLC.Semantics.html#2425" class="Bound">x</a><a id="2426" class="Symbol">)</a>     <a id="2432" class="Symbol">=</a>
  <a id="2436" href="STLC.Semantics.html#getEnv" class="Function">getEnv</a> <a id="2443" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="2447" class="Symbol">λ</a> <a id="2449" href="STLC.Semantics.html#2449" class="Bound">E</a> <a id="2451" class="Symbol">→</a>
  <a id="2455" href="STLC.Semantics.html#return" class="Function">return</a> <a id="2462" class="Symbol">(</a><a id="2463" href="Data.List.All.html#lookup" class="Function">lookup</a> <a id="2470" href="STLC.Semantics.html#2449" class="Bound">E</a> <a id="2472" href="STLC.Semantics.html#2425" class="Bound">x</a><a id="2473" class="Symbol">)</a>
<a id="2475" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2480" class="Symbol">(</a><a id="2481" href="Agda.Builtin.Nat.html#Nat.suc" class="InductiveConstructor">suc</a> <a id="2485" href="STLC.Semantics.html#2485" class="Bound">k</a><a id="2486" class="Symbol">)</a>  <a id="2489" class="Symbol">(</a><a id="2490" href="STLC.Semantics.html#Expr.%C6%9B" class="InductiveConstructor">ƛ</a> <a id="2492" href="STLC.Semantics.html#2492" class="Bound">b</a><a id="2493" class="Symbol">)</a>       <a id="2501" class="Symbol">=</a>
  <a id="2505" href="STLC.Semantics.html#getEnv" class="Function">getEnv</a> <a id="2512" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="2516" class="Symbol">λ</a> <a id="2518" href="STLC.Semantics.html#2518" class="Bound">E</a> <a id="2520" class="Symbol">→</a>
  <a id="2524" href="STLC.Semantics.html#return" class="Function">return</a> <a id="2531" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟨</a> <a id="2533" href="STLC.Semantics.html#2492" class="Bound">b</a> <a id="2535" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">,</a> <a id="2537" href="STLC.Semantics.html#2518" class="Bound">E</a> <a id="2539" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟩</a>
<a id="2541" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2546" class="Symbol">(</a><a id="2547" href="Agda.Builtin.Nat.html#Nat.suc" class="InductiveConstructor">suc</a> <a id="2551" href="STLC.Semantics.html#2551" class="Bound">k</a><a id="2552" class="Symbol">)</a>  <a id="2555" class="Symbol">(</a><a id="2556" href="STLC.Semantics.html#2556" class="Bound">l</a> <a id="2558" href="STLC.Semantics.html#Expr._%C2%B7_" class="InductiveConstructor Operator">·</a> <a id="2560" href="STLC.Semantics.html#2560" class="Bound">r</a><a id="2561" class="Symbol">)</a>     <a id="2567" class="Symbol">=</a>
  <a id="2571" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2576" href="STLC.Semantics.html#2551" class="Bound">k</a> <a id="2578" href="STLC.Semantics.html#2556" class="Bound">l</a> <a id="2580" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="2584" class="Symbol">λ{</a> <a id="2587" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟨</a> <a id="2589" href="STLC.Semantics.html#2589" class="Bound">e</a> <a id="2591" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">,</a> <a id="2593" href="STLC.Semantics.html#2593" class="Bound">E</a> <a id="2595" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟩</a> <a id="2597" class="Symbol">→</a>
  <a id="2601" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2606" href="STLC.Semantics.html#2551" class="Bound">k</a> <a id="2608" href="STLC.Semantics.html#2560" class="Bound">r</a> <a id="2610" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="2614" class="Symbol">λ</a> <a id="2616" href="STLC.Semantics.html#2616" class="Bound">v</a> <a id="2618" class="Symbol">→</a>
  <a id="2622" href="STLC.Semantics.html#usingEnv" class="Function">usingEnv</a> <a id="2631" class="Symbol">(</a><a id="2632" href="STLC.Semantics.html#2616" class="Bound">v</a> <a id="2634" href="Data.List.All.html#All._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="2636" href="STLC.Semantics.html#2593" class="Bound">E</a><a id="2637" class="Symbol">)</a> <a id="2639" class="Symbol">(</a><a id="2640" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2645" href="STLC.Semantics.html#2551" class="Bound">k</a> <a id="2647" href="STLC.Semantics.html#2589" class="Bound">e</a><a id="2648" class="Symbol">)</a> <a id="2650" class="Symbol">}</a>
<a id="2652" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2657" class="Symbol">(</a><a id="2658" href="Agda.Builtin.Nat.html#Nat.suc" class="InductiveConstructor">suc</a> <a id="2662" href="STLC.Semantics.html#2662" class="Bound">k</a><a id="2663" class="Symbol">)</a>  <a id="2666" class="Symbol">(</a><a id="2667" href="STLC.Semantics.html#Expr.num" class="InductiveConstructor">num</a> <a id="2671" href="STLC.Semantics.html#2671" class="Bound">x</a><a id="2672" class="Symbol">)</a>     <a id="2678" class="Symbol">=</a>
  <a id="2682" href="STLC.Semantics.html#return" class="Function">return</a> <a id="2689" class="Symbol">(</a><a id="2690" href="STLC.Semantics.html#Val.num" class="InductiveConstructor">num</a> <a id="2694" href="STLC.Semantics.html#2671" class="Bound">x</a><a id="2695" class="Symbol">)</a>
<a id="2697" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2702" class="Symbol">(</a><a id="2703" href="Agda.Builtin.Nat.html#Nat.suc" class="InductiveConstructor">suc</a> <a id="2707" href="STLC.Semantics.html#2707" class="Bound">k</a><a id="2708" class="Symbol">)</a>  <a id="2711" class="Symbol">(</a><a id="2712" href="STLC.Semantics.html#Expr.iop" class="InductiveConstructor">iop</a> <a id="2716" href="STLC.Semantics.html#2716" class="Bound">f</a> <a id="2718" href="STLC.Semantics.html#2718" class="Bound">l</a> <a id="2720" href="STLC.Semantics.html#2720" class="Bound">r</a><a id="2721" class="Symbol">)</a> <a id="2723" class="Symbol">=</a>
  <a id="2727" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2732" href="STLC.Semantics.html#2707" class="Bound">k</a> <a id="2734" href="STLC.Semantics.html#2718" class="Bound">l</a> <a id="2736" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="2740" class="Symbol">λ{</a> <a id="2743" class="Symbol">(</a><a id="2744" href="STLC.Semantics.html#Val.num" class="InductiveConstructor">num</a> <a id="2748" href="STLC.Semantics.html#2748" class="Bound">vₗ</a><a id="2750" class="Symbol">)</a> <a id="2752" class="Symbol">→</a>
  <a id="2756" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2761" href="STLC.Semantics.html#2707" class="Bound">k</a> <a id="2763" href="STLC.Semantics.html#2720" class="Bound">r</a> <a id="2765" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="2769" class="Symbol">λ{</a> <a id="2772" class="Symbol">(</a><a id="2773" href="STLC.Semantics.html#Val.num" class="InductiveConstructor">num</a> <a id="2777" href="STLC.Semantics.html#2777" class="Bound">vᵣ</a><a id="2779" class="Symbol">)</a> <a id="2781" class="Symbol">→</a>
  <a id="2785" href="STLC.Semantics.html#return" class="Function">return</a> <a id="2792" class="Symbol">(</a><a id="2793" href="STLC.Semantics.html#Val.num" class="InductiveConstructor">num</a> <a id="2797" class="Symbol">(</a><a id="2798" href="STLC.Semantics.html#2716" class="Bound">f</a> <a id="2800" href="STLC.Semantics.html#2748" class="Bound">vₗ</a> <a id="2803" href="STLC.Semantics.html#2777" class="Bound">vᵣ</a><a id="2805" class="Symbol">))</a> <a id="2808" class="Symbol">}}</a>
</pre></body></html>