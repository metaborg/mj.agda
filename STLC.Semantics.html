<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>STLC.Semantics</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="STLC.Semantics.html" class="Module">STLC.Semantics</a> <a id="23" class="Keyword">where</a>

<a id="30" class="Comment">-- This file contains the definitional interpreter for STLC described</a>
<a id="100" class="Comment">-- in Section 2 of the paper.</a>

<a id="131" class="Keyword">open</a> <a id="136" class="Keyword">import</a> <a id="143" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="Data.Integer.html" class="Module">Data.Integer</a>
<a id="177" class="Keyword">open</a> <a id="182" class="Keyword">import</a> <a id="189" href="Data.List.Most.html" class="Module">Data.List.Most</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="227" class="Keyword">hiding</a> <a id="234" class="Symbol">(</a><a id="235" href="Data.Maybe.Base.html#All" class="Datatype">All</a><a id="238" class="Symbol">)</a>


<a id="242" class="Comment">------------</a>
<a id="255" class="Comment">-- SYNTAX --</a>
<a id="268" class="Comment">------------</a>

<a id="282" class="Comment">-- These definitions correspond to Section 2.1, except we have</a>
<a id="345" class="Comment">-- included numbers (integers) and integer operations in the language.</a>

<a id="417" class="Keyword">data</a> <a id="Ty" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a> <a id="425" class="Symbol">:</a> <a id="427" class="PrimitiveType">Set</a> <a id="431" class="Keyword">where</a>
  <a id="Ty.unit" href="STLC.Semantics.html#Ty.unit" class="InductiveConstructor">unit</a> <a id="444" class="Symbol">:</a> <a id="446" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a>
  <a id="Ty._⇒_" href="STLC.Semantics.html#Ty._%E2%87%92_" class="InductiveConstructor Operator">_⇒_</a>  <a id="456" class="Symbol">:</a> <a id="458" class="Symbol">(</a><a id="459" href="STLC.Semantics.html#459" class="Bound">a</a> <a id="461" href="STLC.Semantics.html#461" class="Bound">b</a> <a id="463" class="Symbol">:</a> <a id="465" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a><a id="467" class="Symbol">)</a> <a id="469" class="Symbol">→</a> <a id="471" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a>
  <a id="Ty.int" href="STLC.Semantics.html#Ty.int" class="InductiveConstructor">int</a>  <a id="481" class="Symbol">:</a> <a id="483" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a>

<a id="Ctx" href="STLC.Semantics.html#Ctx" class="Function">Ctx</a> <a id="491" class="Symbol">=</a> <a id="493" href="Agda.Builtin.List.html#List" class="Datatype">List</a> <a id="498" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a>

<a id="502" class="Comment">-- Below, `Expr` uses `_∈_` from `Relation.Binary` in the Agda</a>
<a id="565" class="Comment">-- Standard Library to represent typed de Bruijn indices which witness</a>
<a id="636" class="Comment">-- the existence of an entry in the type context.</a>

<a id="687" class="Keyword">data</a> <a id="Expr" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="697" class="Symbol">(</a><a id="698" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="700" class="Symbol">:</a> <a id="702" href="STLC.Semantics.html#Ctx" class="Function">Ctx</a><a id="705" class="Symbol">)</a> <a id="707" class="Symbol">:</a> <a id="709" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a> <a id="712" class="Symbol">→</a> <a id="714" class="PrimitiveType">Set</a> <a id="718" class="Keyword">where</a>
  <a id="Expr.unit" href="STLC.Semantics.html#Expr.unit" class="InductiveConstructor">unit</a>  <a id="732" class="Symbol">:</a> <a id="734" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="739" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="741" href="STLC.Semantics.html#Ty.unit" class="InductiveConstructor">unit</a>
  <a id="Expr.var" href="STLC.Semantics.html#Expr.var" class="InductiveConstructor">var</a>   <a id="754" class="Symbol">:</a> <a id="756" class="Symbol">∀</a> <a id="758" class="Symbol">{</a><a id="759" href="STLC.Semantics.html#759" class="Bound">t</a><a id="760" class="Symbol">}</a> <a id="762" class="Symbol">→</a> <a id="764" href="STLC.Semantics.html#759" class="Bound">t</a> <a id="766" href="Data.List.Any.Membership.html#Propositional.M._%E2%88%88_" class="Function Operator">∈</a> <a id="768" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="770" class="Symbol">→</a> <a id="772" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="777" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="779" href="STLC.Semantics.html#759" class="Bound">t</a>
  <a id="Expr.ƛ" href="STLC.Semantics.html#Expr.%C6%9B" class="InductiveConstructor">ƛ</a>     <a id="789" class="Symbol">:</a> <a id="791" class="Symbol">∀</a> <a id="793" class="Symbol">{</a><a id="794" href="STLC.Semantics.html#794" class="Bound">a</a> <a id="796" href="STLC.Semantics.html#796" class="Bound">b</a><a id="797" class="Symbol">}</a> <a id="799" class="Symbol">→</a> <a id="801" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="806" class="Symbol">(</a><a id="807" href="STLC.Semantics.html#794" class="Bound">a</a> <a id="809" href="Agda.Builtin.List.html#List._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="811" href="STLC.Semantics.html#698" class="Bound">Γ</a><a id="812" class="Symbol">)</a> <a id="814" href="STLC.Semantics.html#796" class="Bound">b</a> <a id="816" class="Symbol">→</a> <a id="818" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="823" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="825" class="Symbol">(</a><a id="826" href="STLC.Semantics.html#794" class="Bound">a</a> <a id="828" href="STLC.Semantics.html#Ty._%E2%87%92_" class="InductiveConstructor Operator">⇒</a> <a id="830" href="STLC.Semantics.html#796" class="Bound">b</a><a id="831" class="Symbol">)</a>
  <a id="Expr._·_" href="STLC.Semantics.html#Expr._%C2%B7_" class="InductiveConstructor Operator">_·_</a>   <a id="841" class="Symbol">:</a> <a id="843" class="Symbol">∀</a> <a id="845" class="Symbol">{</a><a id="846" href="STLC.Semantics.html#846" class="Bound">a</a> <a id="848" href="STLC.Semantics.html#848" class="Bound">b</a><a id="849" class="Symbol">}</a> <a id="851" class="Symbol">→</a> <a id="853" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="858" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="860" class="Symbol">(</a><a id="861" href="STLC.Semantics.html#846" class="Bound">a</a> <a id="863" href="STLC.Semantics.html#Ty._%E2%87%92_" class="InductiveConstructor Operator">⇒</a> <a id="865" href="STLC.Semantics.html#848" class="Bound">b</a><a id="866" class="Symbol">)</a> <a id="868" class="Symbol">→</a> <a id="870" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="875" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="877" href="STLC.Semantics.html#846" class="Bound">a</a> <a id="879" class="Symbol">→</a> <a id="881" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="886" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="888" href="STLC.Semantics.html#848" class="Bound">b</a>
  <a id="Expr.num" href="STLC.Semantics.html#Expr.num" class="InductiveConstructor">num</a>   <a id="898" class="Symbol">:</a> <a id="900" href="Agda.Builtin.Int.html#%E2%84%A4" class="Datatype">ℤ</a> <a id="902" class="Symbol">→</a> <a id="904" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="909" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="911" href="STLC.Semantics.html#Ty.int" class="InductiveConstructor">int</a>
  <a id="Expr.iop" href="STLC.Semantics.html#Expr.iop" class="InductiveConstructor">iop</a>   <a id="923" class="Symbol">:</a> <a id="925" class="Symbol">(</a><a id="926" href="Agda.Builtin.Int.html#%E2%84%A4" class="Datatype">ℤ</a> <a id="928" class="Symbol">→</a> <a id="930" href="Agda.Builtin.Int.html#%E2%84%A4" class="Datatype">ℤ</a> <a id="932" class="Symbol">→</a> <a id="934" href="Agda.Builtin.Int.html#%E2%84%A4" class="Datatype">ℤ</a><a id="935" class="Symbol">)</a> <a id="937" class="Symbol">→</a> <a id="939" class="Symbol">(</a><a id="940" href="STLC.Semantics.html#940" class="Bound">l</a> <a id="942" href="STLC.Semantics.html#942" class="Bound">r</a> <a id="944" class="Symbol">:</a> <a id="946" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="951" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="953" href="STLC.Semantics.html#Ty.int" class="InductiveConstructor">int</a><a id="956" class="Symbol">)</a> <a id="958" class="Symbol">→</a> <a id="960" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="965" href="STLC.Semantics.html#698" class="Bound">Γ</a> <a id="967" href="STLC.Semantics.html#Ty.int" class="InductiveConstructor">int</a>


<a id="973" class="Comment">-----------------------------</a>
<a id="1003" class="Comment">-- VALUES AND ENVIRONMENTS --</a>
<a id="1033" class="Comment">-----------------------------</a>

<a id="1064" class="Comment">-- These definitions correspond to Section 2.2.</a>
<a id="1112" class="Comment">--</a>
<a id="1115" class="Comment">-- Note that the `All` type described in Section 2.2 of the paper (for</a>
<a id="1186" class="Comment">-- simplicity) does not mention universe levels, whereas the `All`</a>
<a id="1253" class="Comment">-- definition below refers to `Data.List.All` in the Agda Standard</a>
<a id="1320" class="Comment">-- Library which is defined in a universe polymorphic manner.</a>

<a id="1383" class="Keyword">mutual</a>
  <a id="1392" class="Keyword">data</a> <a id="Val" href="STLC.Semantics.html#Val" class="Datatype">Val</a> <a id="1401" class="Symbol">:</a> <a id="1403" href="STLC.Semantics.html#Ty" class="Datatype">Ty</a> <a id="1406" class="Symbol">→</a> <a id="1408" class="PrimitiveType">Set</a> <a id="1412" class="Keyword">where</a>
    <a id="Val.unit" href="STLC.Semantics.html#Val.unit" class="InductiveConstructor">unit</a>  <a id="1428" class="Symbol">:</a> <a id="1430" href="STLC.Semantics.html#Val" class="Datatype">Val</a> <a id="1434" href="STLC.Semantics.html#Ty.unit" class="InductiveConstructor">unit</a>
    <a id="Val.⟨_,_⟩" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟨_,_⟩</a> <a id="1449" class="Symbol">:</a> <a id="1451" class="Symbol">∀</a> <a id="1453" class="Symbol">{</a><a id="1454" href="STLC.Semantics.html#1454" class="Bound">Γ</a> <a id="1456" href="STLC.Semantics.html#1456" class="Bound">a</a> <a id="1458" href="STLC.Semantics.html#1458" class="Bound">b</a><a id="1459" class="Symbol">}</a> <a id="1461" class="Symbol">→</a> <a id="1463" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="1468" class="Symbol">(</a><a id="1469" href="STLC.Semantics.html#1456" class="Bound">a</a> <a id="1471" href="Agda.Builtin.List.html#List._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="1473" href="STLC.Semantics.html#1454" class="Bound">Γ</a><a id="1474" class="Symbol">)</a> <a id="1476" href="STLC.Semantics.html#1458" class="Bound">b</a> <a id="1478" class="Symbol">→</a> <a id="1480" href="STLC.Semantics.html#Env" class="Function">Env</a> <a id="1484" href="STLC.Semantics.html#1454" class="Bound">Γ</a> <a id="1486" class="Symbol">→</a> <a id="1488" href="STLC.Semantics.html#Val" class="Datatype">Val</a> <a id="1492" class="Symbol">(</a><a id="1493" href="STLC.Semantics.html#1456" class="Bound">a</a> <a id="1495" href="STLC.Semantics.html#Ty._%E2%87%92_" class="InductiveConstructor Operator">⇒</a> <a id="1497" href="STLC.Semantics.html#1458" class="Bound">b</a><a id="1498" class="Symbol">)</a>
    <a id="Val.num" href="STLC.Semantics.html#Val.num" class="InductiveConstructor">num</a>   <a id="1510" class="Symbol">:</a> <a id="1512" href="Agda.Builtin.Int.html#%E2%84%A4" class="Datatype">ℤ</a> <a id="1514" class="Symbol">→</a> <a id="1516" href="STLC.Semantics.html#Val" class="Datatype">Val</a> <a id="1520" href="STLC.Semantics.html#Ty.int" class="InductiveConstructor">int</a>

  <a id="Env" href="STLC.Semantics.html#Env" class="Function">Env</a> <a id="1531" class="Symbol">:</a> <a id="1533" href="STLC.Semantics.html#Ctx" class="Function">Ctx</a> <a id="1537" class="Symbol">→</a> <a id="1539" class="PrimitiveType">Set</a>
  <a id="1545" href="STLC.Semantics.html#Env" class="Function">Env</a> <a id="1549" href="STLC.Semantics.html#1549" class="Bound">Γ</a> <a id="1551" class="Symbol">=</a> <a id="1553" href="Data.List.All.html#All" class="Datatype">All</a> <a id="1557" href="STLC.Semantics.html#Val" class="Datatype">Val</a> <a id="1561" href="STLC.Semantics.html#1549" class="Bound">Γ</a>

<a id="1564" class="Comment">-- The `lookup` function described in Section 2.2 of the paper is also</a>
<a id="1635" class="Comment">-- defined in `Data.List.All` Agda Standard Library.</a>


<a id="1690" class="Comment">-----------</a>
<a id="1702" class="Comment">-- MONAD --</a>
<a id="1714" class="Comment">-----------</a>

<a id="1727" class="Comment">-- These definitions correspond to Section 2.3.</a>

<a id="M" href="STLC.Semantics.html#M" class="Function">M</a> <a id="1778" class="Symbol">:</a> <a id="1780" href="STLC.Semantics.html#Ctx" class="Function">Ctx</a> <a id="1784" class="Symbol">→</a> <a id="1786" class="PrimitiveType">Set</a> <a id="1790" class="Symbol">→</a> <a id="1792" class="PrimitiveType">Set</a>
<a id="1796" href="STLC.Semantics.html#M" class="Function">M</a> <a id="1798" href="STLC.Semantics.html#1798" class="Bound">Γ</a> <a id="1800" href="STLC.Semantics.html#1800" class="Bound">a</a>  <a id="1803" class="Symbol">=</a>  <a id="1806" href="STLC.Semantics.html#Env" class="Function">Env</a> <a id="1810" href="STLC.Semantics.html#1798" class="Bound">Γ</a> <a id="1812" class="Symbol">→</a> <a id="1814" href="Data.Maybe.Base.html#Maybe" class="Datatype">Maybe</a> <a id="1820" href="STLC.Semantics.html#1800" class="Bound">a</a>

<a id="_&gt;&gt;=_" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">_&gt;&gt;=_</a>    <a id="1832" class="Symbol">:</a> <a id="1834" class="Symbol">∀</a> <a id="1836" class="Symbol">{</a><a id="1837" href="STLC.Semantics.html#1837" class="Bound">Γ</a> <a id="1839" href="STLC.Semantics.html#1839" class="Bound">a</a> <a id="1841" href="STLC.Semantics.html#1841" class="Bound">b</a><a id="1842" class="Symbol">}</a> <a id="1844" class="Symbol">→</a> <a id="1846" href="STLC.Semantics.html#M" class="Function">M</a> <a id="1848" href="STLC.Semantics.html#1837" class="Bound">Γ</a> <a id="1850" href="STLC.Semantics.html#1839" class="Bound">a</a> <a id="1852" class="Symbol">→</a> <a id="1854" class="Symbol">(</a><a id="1855" href="STLC.Semantics.html#1839" class="Bound">a</a> <a id="1857" class="Symbol">→</a> <a id="1859" href="STLC.Semantics.html#M" class="Function">M</a> <a id="1861" href="STLC.Semantics.html#1837" class="Bound">Γ</a> <a id="1863" href="STLC.Semantics.html#1841" class="Bound">b</a><a id="1864" class="Symbol">)</a> <a id="1866" class="Symbol">→</a> <a id="1868" href="STLC.Semantics.html#M" class="Function">M</a> <a id="1870" href="STLC.Semantics.html#1837" class="Bound">Γ</a> <a id="1872" href="STLC.Semantics.html#1841" class="Bound">b</a>
<a id="1874" class="Symbol">(</a><a id="1875" href="STLC.Semantics.html#1875" class="Bound">f</a> <a id="1877" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="1881" href="STLC.Semantics.html#1881" class="Bound">c</a><a id="1882" class="Symbol">)</a> <a id="1884" href="STLC.Semantics.html#1884" class="Bound">E</a> <a id="1886" class="Keyword">with</a> <a id="1891" class="Symbol">(</a><a id="1892" href="STLC.Semantics.html#1875" class="Bound">f</a> <a id="1894" href="STLC.Semantics.html#1884" class="Bound">E</a><a id="1895" class="Symbol">)</a>
<a id="1897" class="Symbol">...</a> <a id="1901" class="Symbol">|</a> <a id="1903" href="Data.Maybe.Base.html#Maybe.just" class="InductiveConstructor">just</a> <a id="1908" href="STLC.Semantics.html#1908" class="Bound">x</a> <a id="1910" class="Symbol">=</a> <a id="1912" class="Bound">c</a> <a id="1914" href="STLC.Semantics.html#1908" class="Bound">x</a> <a id="1916" class="Bound">E</a>
<a id="1918" class="Symbol">...</a> <a id="1922" class="Symbol">|</a> <a id="1924" href="Data.Maybe.Base.html#Maybe.nothing" class="InductiveConstructor">nothing</a> <a id="1932" class="Symbol">=</a> <a id="1934" href="Data.Maybe.Base.html#Maybe.nothing" class="InductiveConstructor">nothing</a>

<a id="return" href="STLC.Semantics.html#return" class="Function">return</a>   <a id="1952" class="Symbol">:</a> <a id="1954" class="Symbol">∀</a> <a id="1956" class="Symbol">{</a><a id="1957" href="STLC.Semantics.html#1957" class="Bound">Γ</a> <a id="1959" href="STLC.Semantics.html#1959" class="Bound">a</a><a id="1960" class="Symbol">}</a> <a id="1962" class="Symbol">→</a> <a id="1964" href="STLC.Semantics.html#1959" class="Bound">a</a> <a id="1966" class="Symbol">→</a> <a id="1968" href="STLC.Semantics.html#M" class="Function">M</a> <a id="1970" href="STLC.Semantics.html#1957" class="Bound">Γ</a> <a id="1972" href="STLC.Semantics.html#1959" class="Bound">a</a>
<a id="1974" href="STLC.Semantics.html#return" class="Function">return</a> <a id="1981" href="STLC.Semantics.html#1981" class="Bound">x</a> <a id="1983" href="STLC.Semantics.html#1983" class="Bound">E</a> <a id="1985" class="Symbol">=</a> <a id="1987" href="Data.Maybe.Base.html#Maybe.just" class="InductiveConstructor">just</a> <a id="1992" href="STLC.Semantics.html#1981" class="Bound">x</a>

<a id="getEnv" href="STLC.Semantics.html#getEnv" class="Function">getEnv</a>   <a id="2004" class="Symbol">:</a> <a id="2006" class="Symbol">∀</a> <a id="2008" class="Symbol">{</a><a id="2009" href="STLC.Semantics.html#2009" class="Bound">Γ</a><a id="2010" class="Symbol">}</a> <a id="2012" class="Symbol">→</a> <a id="2014" href="STLC.Semantics.html#M" class="Function">M</a> <a id="2016" href="STLC.Semantics.html#2009" class="Bound">Γ</a> <a id="2018" class="Symbol">(</a><a id="2019" href="STLC.Semantics.html#Env" class="Function">Env</a> <a id="2023" href="STLC.Semantics.html#2009" class="Bound">Γ</a><a id="2024" class="Symbol">)</a>
<a id="2026" href="STLC.Semantics.html#getEnv" class="Function">getEnv</a> <a id="2033" href="STLC.Semantics.html#2033" class="Bound">E</a> <a id="2035" class="Symbol">=</a> <a id="2037" href="STLC.Semantics.html#return" class="Function">return</a> <a id="2044" href="STLC.Semantics.html#2033" class="Bound">E</a> <a id="2046" href="STLC.Semantics.html#2033" class="Bound">E</a>

<a id="usingEnv" href="STLC.Semantics.html#usingEnv" class="Function">usingEnv</a> <a id="2058" class="Symbol">:</a> <a id="2060" class="Symbol">∀</a> <a id="2062" class="Symbol">{</a><a id="2063" href="STLC.Semantics.html#2063" class="Bound">Γ</a> <a id="2065" href="STLC.Semantics.html#2065" class="Bound">Γ&#39;</a> <a id="2068" href="STLC.Semantics.html#2068" class="Bound">a</a><a id="2069" class="Symbol">}</a> <a id="2071" class="Symbol">→</a> <a id="2073" href="STLC.Semantics.html#Env" class="Function">Env</a> <a id="2077" href="STLC.Semantics.html#2063" class="Bound">Γ</a> <a id="2079" class="Symbol">→</a> <a id="2081" href="STLC.Semantics.html#M" class="Function">M</a> <a id="2083" href="STLC.Semantics.html#2063" class="Bound">Γ</a> <a id="2085" href="STLC.Semantics.html#2068" class="Bound">a</a> <a id="2087" class="Symbol">→</a> <a id="2089" href="STLC.Semantics.html#M" class="Function">M</a> <a id="2091" href="STLC.Semantics.html#2065" class="Bound">Γ&#39;</a> <a id="2094" href="STLC.Semantics.html#2068" class="Bound">a</a>
<a id="2096" href="STLC.Semantics.html#usingEnv" class="Function">usingEnv</a> <a id="2105" href="STLC.Semantics.html#2105" class="Bound">E</a> <a id="2107" href="STLC.Semantics.html#2107" class="Bound">f</a> <a id="2109" class="Symbol">_</a> <a id="2111" class="Symbol">=</a> <a id="2113" href="STLC.Semantics.html#2107" class="Bound">f</a> <a id="2115" href="STLC.Semantics.html#2105" class="Bound">E</a>

<a id="timeout" href="STLC.Semantics.html#timeout" class="Function">timeout</a>  <a id="2127" class="Symbol">:</a> <a id="2129" class="Symbol">∀</a> <a id="2131" class="Symbol">{</a><a id="2132" href="STLC.Semantics.html#2132" class="Bound">Γ</a> <a id="2134" href="STLC.Semantics.html#2134" class="Bound">a</a><a id="2135" class="Symbol">}</a> <a id="2137" class="Symbol">→</a> <a id="2139" href="STLC.Semantics.html#M" class="Function">M</a> <a id="2141" href="STLC.Semantics.html#2132" class="Bound">Γ</a> <a id="2143" href="STLC.Semantics.html#2134" class="Bound">a</a>
<a id="2145" href="STLC.Semantics.html#timeout" class="Function">timeout</a> <a id="2153" class="Symbol">=</a> <a id="2155" class="Symbol">λ</a> <a id="2157" href="STLC.Semantics.html#2157" class="Bound">_</a> <a id="2159" class="Symbol">→</a> <a id="2161" href="Data.Maybe.Base.html#Maybe.nothing" class="InductiveConstructor">nothing</a>


<a id="2171" class="Comment">-----------------</a>
<a id="2189" class="Comment">-- INTERPRETER --</a>
<a id="2207" class="Comment">-----------------</a>

<a id="2226" class="Comment">-- These definitions correspond to Section 2.4.</a>

<a id="eval" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2280" class="Symbol">:</a> <a id="2282" href="Agda.Builtin.Nat.html#%E2%84%95" class="Datatype">ℕ</a> <a id="2284" class="Symbol">→</a> <a id="2286" class="Symbol">∀</a> <a id="2288" class="Symbol">{</a><a id="2289" href="STLC.Semantics.html#2289" class="Bound">Γ</a> <a id="2291" href="STLC.Semantics.html#2291" class="Bound">t</a><a id="2292" class="Symbol">}</a> <a id="2294" class="Symbol">→</a> <a id="2296" href="STLC.Semantics.html#Expr" class="Datatype">Expr</a> <a id="2301" href="STLC.Semantics.html#2289" class="Bound">Γ</a> <a id="2303" href="STLC.Semantics.html#2291" class="Bound">t</a> <a id="2305" class="Symbol">→</a> <a id="2307" href="STLC.Semantics.html#M" class="Function">M</a> <a id="2309" href="STLC.Semantics.html#2289" class="Bound">Γ</a> <a id="2311" class="Symbol">(</a><a id="2312" href="STLC.Semantics.html#Val" class="Datatype">Val</a> <a id="2316" href="STLC.Semantics.html#2291" class="Bound">t</a><a id="2317" class="Symbol">)</a>
<a id="2319" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2324" href="Agda.Builtin.Nat.html#Nat.zero" class="InductiveConstructor">zero</a>     <a id="2333" class="Symbol">_</a>           <a id="2345" class="Symbol">=</a>
  <a id="2349" href="STLC.Semantics.html#timeout" class="Function">timeout</a>
<a id="2357" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2362" class="Symbol">(</a><a id="2363" href="Agda.Builtin.Nat.html#Nat.suc" class="InductiveConstructor">suc</a> <a id="2367" href="STLC.Semantics.html#2367" class="Bound">k</a><a id="2368" class="Symbol">)</a>  <a id="2371" href="STLC.Semantics.html#Expr.unit" class="InductiveConstructor">unit</a>        <a id="2383" class="Symbol">=</a>
  <a id="2387" href="STLC.Semantics.html#return" class="Function">return</a> <a id="2394" href="STLC.Semantics.html#Val.unit" class="InductiveConstructor">unit</a>
<a id="2399" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2404" class="Symbol">(</a><a id="2405" href="Agda.Builtin.Nat.html#Nat.suc" class="InductiveConstructor">suc</a> <a id="2409" href="STLC.Semantics.html#2409" class="Bound">k</a><a id="2410" class="Symbol">)</a>  <a id="2413" class="Symbol">(</a><a id="2414" href="STLC.Semantics.html#Expr.var" class="InductiveConstructor">var</a> <a id="2418" href="STLC.Semantics.html#2418" class="Bound">x</a><a id="2419" class="Symbol">)</a>     <a id="2425" class="Symbol">=</a>
  <a id="2429" href="STLC.Semantics.html#getEnv" class="Function">getEnv</a> <a id="2436" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="2440" class="Symbol">λ</a> <a id="2442" href="STLC.Semantics.html#2442" class="Bound">E</a> <a id="2444" class="Symbol">→</a>
  <a id="2448" href="STLC.Semantics.html#return" class="Function">return</a> <a id="2455" class="Symbol">(</a><a id="2456" href="Data.List.All.html#lookup" class="Function">lookup</a> <a id="2463" href="STLC.Semantics.html#2442" class="Bound">E</a> <a id="2465" href="STLC.Semantics.html#2418" class="Bound">x</a><a id="2466" class="Symbol">)</a>
<a id="2468" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2473" class="Symbol">(</a><a id="2474" href="Agda.Builtin.Nat.html#Nat.suc" class="InductiveConstructor">suc</a> <a id="2478" href="STLC.Semantics.html#2478" class="Bound">k</a><a id="2479" class="Symbol">)</a>  <a id="2482" class="Symbol">(</a><a id="2483" href="STLC.Semantics.html#Expr.%C6%9B" class="InductiveConstructor">ƛ</a> <a id="2485" href="STLC.Semantics.html#2485" class="Bound">b</a><a id="2486" class="Symbol">)</a>       <a id="2494" class="Symbol">=</a>
  <a id="2498" href="STLC.Semantics.html#getEnv" class="Function">getEnv</a> <a id="2505" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="2509" class="Symbol">λ</a> <a id="2511" href="STLC.Semantics.html#2511" class="Bound">E</a> <a id="2513" class="Symbol">→</a>
  <a id="2517" href="STLC.Semantics.html#return" class="Function">return</a> <a id="2524" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟨</a> <a id="2526" href="STLC.Semantics.html#2485" class="Bound">b</a> <a id="2528" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">,</a> <a id="2530" href="STLC.Semantics.html#2511" class="Bound">E</a> <a id="2532" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟩</a>
<a id="2534" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2539" class="Symbol">(</a><a id="2540" href="Agda.Builtin.Nat.html#Nat.suc" class="InductiveConstructor">suc</a> <a id="2544" href="STLC.Semantics.html#2544" class="Bound">k</a><a id="2545" class="Symbol">)</a>  <a id="2548" class="Symbol">(</a><a id="2549" href="STLC.Semantics.html#2549" class="Bound">l</a> <a id="2551" href="STLC.Semantics.html#Expr._%C2%B7_" class="InductiveConstructor Operator">·</a> <a id="2553" href="STLC.Semantics.html#2553" class="Bound">r</a><a id="2554" class="Symbol">)</a>     <a id="2560" class="Symbol">=</a>
  <a id="2564" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2569" href="STLC.Semantics.html#2544" class="Bound">k</a> <a id="2571" href="STLC.Semantics.html#2549" class="Bound">l</a> <a id="2573" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="2577" class="Symbol">λ{</a> <a id="2580" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟨</a> <a id="2582" href="STLC.Semantics.html#2582" class="Bound">e</a> <a id="2584" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">,</a> <a id="2586" href="STLC.Semantics.html#2586" class="Bound">E</a> <a id="2588" href="STLC.Semantics.html#Val.%E2%9F%A8_%2C_%E2%9F%A9" class="InductiveConstructor Operator">⟩</a> <a id="2590" class="Symbol">→</a>
  <a id="2594" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2599" href="STLC.Semantics.html#2544" class="Bound">k</a> <a id="2601" href="STLC.Semantics.html#2553" class="Bound">r</a> <a id="2603" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="2607" class="Symbol">λ</a> <a id="2609" href="STLC.Semantics.html#2609" class="Bound">v</a> <a id="2611" class="Symbol">→</a>
  <a id="2615" href="STLC.Semantics.html#usingEnv" class="Function">usingEnv</a> <a id="2624" class="Symbol">(</a><a id="2625" href="STLC.Semantics.html#2609" class="Bound">v</a> <a id="2627" href="Data.List.All.html#All._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="2629" href="STLC.Semantics.html#2586" class="Bound">E</a><a id="2630" class="Symbol">)</a> <a id="2632" class="Symbol">(</a><a id="2633" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2638" href="STLC.Semantics.html#2544" class="Bound">k</a> <a id="2640" href="STLC.Semantics.html#2582" class="Bound">e</a><a id="2641" class="Symbol">)</a> <a id="2643" class="Symbol">}</a>
<a id="2645" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2650" class="Symbol">(</a><a id="2651" href="Agda.Builtin.Nat.html#Nat.suc" class="InductiveConstructor">suc</a> <a id="2655" href="STLC.Semantics.html#2655" class="Bound">k</a><a id="2656" class="Symbol">)</a>  <a id="2659" class="Symbol">(</a><a id="2660" href="STLC.Semantics.html#Expr.num" class="InductiveConstructor">num</a> <a id="2664" href="STLC.Semantics.html#2664" class="Bound">x</a><a id="2665" class="Symbol">)</a>     <a id="2671" class="Symbol">=</a>
  <a id="2675" href="STLC.Semantics.html#return" class="Function">return</a> <a id="2682" class="Symbol">(</a><a id="2683" href="STLC.Semantics.html#Val.num" class="InductiveConstructor">num</a> <a id="2687" href="STLC.Semantics.html#2664" class="Bound">x</a><a id="2688" class="Symbol">)</a>
<a id="2690" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2695" class="Symbol">(</a><a id="2696" href="Agda.Builtin.Nat.html#Nat.suc" class="InductiveConstructor">suc</a> <a id="2700" href="STLC.Semantics.html#2700" class="Bound">k</a><a id="2701" class="Symbol">)</a>  <a id="2704" class="Symbol">(</a><a id="2705" href="STLC.Semantics.html#Expr.iop" class="InductiveConstructor">iop</a> <a id="2709" href="STLC.Semantics.html#2709" class="Bound">f</a> <a id="2711" href="STLC.Semantics.html#2711" class="Bound">l</a> <a id="2713" href="STLC.Semantics.html#2713" class="Bound">r</a><a id="2714" class="Symbol">)</a> <a id="2716" class="Symbol">=</a>
  <a id="2720" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2725" href="STLC.Semantics.html#2700" class="Bound">k</a> <a id="2727" href="STLC.Semantics.html#2711" class="Bound">l</a> <a id="2729" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="2733" class="Symbol">λ{</a> <a id="2736" class="Symbol">(</a><a id="2737" href="STLC.Semantics.html#Val.num" class="InductiveConstructor">num</a> <a id="2741" href="STLC.Semantics.html#2741" class="Bound">vₗ</a><a id="2743" class="Symbol">)</a> <a id="2745" class="Symbol">→</a>
  <a id="2749" href="STLC.Semantics.html#eval" class="Function">eval</a> <a id="2754" href="STLC.Semantics.html#2700" class="Bound">k</a> <a id="2756" href="STLC.Semantics.html#2713" class="Bound">r</a> <a id="2758" href="STLC.Semantics.html#_%3E%3E%3D_" class="Function Operator">&gt;&gt;=</a> <a id="2762" class="Symbol">λ{</a> <a id="2765" class="Symbol">(</a><a id="2766" href="STLC.Semantics.html#Val.num" class="InductiveConstructor">num</a> <a id="2770" href="STLC.Semantics.html#2770" class="Bound">vᵣ</a><a id="2772" class="Symbol">)</a> <a id="2774" class="Symbol">→</a>
  <a id="2778" href="STLC.Semantics.html#return" class="Function">return</a> <a id="2785" class="Symbol">(</a><a id="2786" href="STLC.Semantics.html#Val.num" class="InductiveConstructor">num</a> <a id="2790" class="Symbol">(</a><a id="2791" href="STLC.Semantics.html#2709" class="Bound">f</a> <a id="2793" href="STLC.Semantics.html#2741" class="Bound">vₗ</a> <a id="2796" href="STLC.Semantics.html#2770" class="Bound">vᵣ</a><a id="2798" class="Symbol">))</a> <a id="2801" class="Symbol">}}</a>
</pre></body></html>