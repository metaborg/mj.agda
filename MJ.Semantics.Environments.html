<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>MJ.Semantics.Environments</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="MJ.Types.html" class="Module">MJ.Types</a> <a id="22" class="Symbol">as</a> <a id="25" class="Module">Types</a>
<a id="31" class="Keyword">import</a> <a id="38" href="MJ.Classtable.Core.html" class="Module">MJ.Classtable.Core</a> <a id="57" class="Symbol">as</a> <a id="60" class="Module">Core</a>

<a id="66" class="Keyword">module</a> <a id="73" href="MJ.Semantics.Environments.html" class="Module">MJ.Semantics.Environments</a> <a id="99" class="Symbol">{</a><a id="100" href="MJ.Semantics.Environments.html#100" class="Bound">c</a><a id="101" class="Symbol">}(</a><a id="103" href="MJ.Semantics.Environments.html#103" class="Bound">Ct</a> <a id="106" class="Symbol">:</a> <a id="108" href="MJ.Classtable.Core.html#Classtable" class="Record">Core.Classtable</a> <a id="124" href="MJ.Semantics.Environments.html#100" class="Bound">c</a><a id="125" class="Symbol">)</a> <a id="127" class="Keyword">where</a>

<a id="134" class="Keyword">open</a> <a id="139" class="Keyword">import</a> <a id="146" href="Prelude.html" class="Module">Prelude</a>
<a id="154" class="Keyword">open</a> <a id="159" class="Keyword">import</a> <a id="166" href="Data.List.Most.html" class="Module">Data.List.Most</a>

<a id="182" class="Keyword">open</a> <a id="187" class="Keyword">import</a> <a id="194" href="MJ.LexicalScope.html" class="Module">MJ.LexicalScope</a> <a id="210" href="MJ.Semantics.Environments.html#100" class="Bound">c</a>

<a id="213" class="Comment">{-
We equip MJ with mutable lexical environments.
We could choose to model this directly, moving the environment from
the Reader part of the evaluation monad to the State part.

Instead we choose to keep our environments immutable and model
mutability of the values in it by an indirection via the mutable store.
This greatly simplifies the treatment of environments in the interpreter
and keeps the representation lightweight, even though we support block scopes.
-}</a>
<a id="Env" href="MJ.Semantics.Environments.html#Env" class="Function">Env</a> <a id="685" class="Symbol">:</a> <a id="687" class="Symbol">∀</a> <a id="689" class="Symbol">(</a><a id="690" href="MJ.Semantics.Environments.html#690" class="Bound">Γ</a> <a id="692" class="Symbol">:</a> <a id="694" href="MJ.LexicalScope.html#206" class="Function">Ctx</a><a id="697" class="Symbol">)(</a><a id="699" href="MJ.Semantics.Environments.html#699" class="Bound">W</a> <a id="701" class="Symbol">:</a> <a id="703" href="MJ.Types.html#World" class="Function">World</a> <a id="709" href="MJ.Semantics.Environments.html#100" class="Bound">c</a><a id="710" class="Symbol">)</a> <a id="712" class="Symbol">→</a> <a id="714" class="PrimitiveType">Set</a>
<a id="718" href="MJ.Semantics.Environments.html#Env" class="Function">Env</a> <a id="722" href="MJ.Semantics.Environments.html#722" class="Bound">Γ</a> <a id="724" href="MJ.Semantics.Environments.html#724" class="Bound">W</a> <a id="726" class="Symbol">=</a> <a id="728" href="Data.List.All.html#All" class="Datatype">All</a> <a id="732" class="Symbol">(λ</a> <a id="735" href="MJ.Semantics.Environments.html#735" class="Bound">a</a> <a id="737" class="Symbol">→</a> <a id="739" href="MJ.Types.html#Ty%E2%81%BA.vty" class="InductiveConstructor">vty</a> <a id="743" href="MJ.Semantics.Environments.html#735" class="Bound">a</a> <a id="745" href="Data.List.Any.Membership.html#Propositional.M._%E2%88%88_" class="Function Operator">∈</a> <a id="747" href="MJ.Semantics.Environments.html#724" class="Bound">W</a><a id="748" class="Symbol">)</a> <a id="750" href="MJ.Semantics.Environments.html#722" class="Bound">Γ</a>

<a id="_⊕_" href="MJ.Semantics.Environments.html#_%E2%8A%95_" class="Function Operator">_⊕_</a> <a id="757" class="Symbol">:</a> <a id="759" class="Symbol">∀</a> <a id="761" class="Symbol">{</a><a id="762" href="MJ.Semantics.Environments.html#762" class="Bound">Γ</a> <a id="764" href="MJ.Semantics.Environments.html#764" class="Bound">W</a> <a id="766" href="MJ.Semantics.Environments.html#766" class="Bound">a</a><a id="767" class="Symbol">}</a> <a id="769" class="Symbol">→</a> <a id="771" href="MJ.Semantics.Environments.html#Env" class="Function">Env</a> <a id="775" href="MJ.Semantics.Environments.html#762" class="Bound">Γ</a> <a id="777" href="MJ.Semantics.Environments.html#764" class="Bound">W</a> <a id="779" class="Symbol">→</a> <a id="781" class="Symbol">(</a><a id="782" href="MJ.Types.html#Ty%E2%81%BA.vty" class="InductiveConstructor">vty</a> <a id="786" href="MJ.Semantics.Environments.html#766" class="Bound">a</a><a id="787" class="Symbol">)</a> <a id="789" href="Data.List.Any.Membership.html#Propositional.M._%E2%88%88_" class="Function Operator">∈</a> <a id="791" href="MJ.Semantics.Environments.html#764" class="Bound">W</a> <a id="793" class="Symbol">→</a> <a id="795" href="MJ.Semantics.Environments.html#Env" class="Function">Env</a> <a id="799" class="Symbol">(</a><a id="800" href="MJ.Semantics.Environments.html#762" class="Bound">Γ</a> <a id="802" href="MJ.LexicalScope.html#275" class="Function Operator">+local</a> <a id="809" href="MJ.Semantics.Environments.html#766" class="Bound">a</a><a id="810" class="Symbol">)</a> <a id="812" href="MJ.Semantics.Environments.html#764" class="Bound">W</a>
<a id="814" href="MJ.Semantics.Environments.html#_%E2%8A%95_" class="Function Operator">_⊕_</a> <a id="818" href="MJ.Semantics.Environments.html#818" class="Bound">E</a> <a id="820" href="MJ.Semantics.Environments.html#820" class="Bound">v</a> <a id="822" class="Symbol">=</a> <a id="824" href="MJ.Semantics.Environments.html#820" class="Bound">v</a> <a id="826" href="Data.List.All.html#All._%E2%88%B7_" class="InductiveConstructor Operator">∷</a> <a id="828" href="MJ.Semantics.Environments.html#818" class="Bound">E</a>

<a id="831" class="Keyword">open</a> <a id="836" class="Keyword">import</a> <a id="843" href="Data.List.Any.html" class="Module">Data.List.Any</a>
<a id="getvar" href="MJ.Semantics.Environments.html#getvar" class="Function">getvar</a> <a id="864" class="Symbol">:</a> <a id="866" class="Symbol">∀</a> <a id="868" class="Symbol">{</a><a id="869" href="MJ.Semantics.Environments.html#869" class="Bound">Γ</a> <a id="871" href="MJ.Semantics.Environments.html#871" class="Bound">W</a> <a id="873" href="MJ.Semantics.Environments.html#873" class="Bound">a</a><a id="874" class="Symbol">}</a> <a id="876" class="Symbol">→</a> <a id="878" href="MJ.LexicalScope.html#235" class="Function">Var</a> <a id="882" href="MJ.Semantics.Environments.html#869" class="Bound">Γ</a> <a id="884" href="MJ.Semantics.Environments.html#873" class="Bound">a</a> <a id="886" class="Symbol">→</a> <a id="888" href="MJ.Semantics.Environments.html#Env" class="Function">Env</a> <a id="892" href="MJ.Semantics.Environments.html#869" class="Bound">Γ</a> <a id="894" href="MJ.Semantics.Environments.html#871" class="Bound">W</a> <a id="896" class="Symbol">→</a> <a id="898" href="MJ.Types.html#Ty%E2%81%BA.vty" class="InductiveConstructor">vty</a> <a id="902" href="MJ.Semantics.Environments.html#873" class="Bound">a</a> <a id="904" href="Data.List.Any.Membership.html#Propositional.M._%E2%88%88_" class="Function Operator">∈</a> <a id="906" href="MJ.Semantics.Environments.html#871" class="Bound">W</a>
<a id="908" href="MJ.Semantics.Environments.html#getvar" class="Function">getvar</a> <a id="915" href="MJ.Semantics.Environments.html#915" class="Bound">px</a> <a id="918" href="MJ.Semantics.Environments.html#918" class="Bound">E</a> <a id="920" class="Symbol">=</a> <a id="922" href="Data.List.All.Properties.Extra.html#%E2%88%88-all" class="Function">∈-all</a> <a id="928" href="MJ.Semantics.Environments.html#915" class="Bound">px</a> <a id="931" href="MJ.Semantics.Environments.html#918" class="Bound">E</a>
</pre></body></html>