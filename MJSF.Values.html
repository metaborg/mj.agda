<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>MJSF.Values</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="22" class="Keyword">open</a> <a id="27" class="Keyword">import</a> <a id="34" href="Data.List.Most.html" class="Module">Data.List.Most</a>
<a id="49" class="Keyword">open</a> <a id="54" class="Keyword">import</a> <a id="61" href="Data.Integer.html" class="Module">Data.Integer</a>
<a id="74" class="Keyword">open</a> <a id="79" class="Keyword">import</a> <a id="86" href="Data.Product.html" class="Module">Data.Product</a>

<a id="100" class="Comment">-- This file contains the definition of values for the definitional</a>
<a id="168" class="Comment">-- interpreter for MJ using scopes and frames, described in Section 5</a>
<a id="238" class="Comment">-- of the paper.</a>

<a id="256" class="Keyword">module</a> <a id="263" href="MJSF.Values.html" class="Module">MJSF.Values</a> <a id="275" class="Symbol">(</a><a id="276" href="MJSF.Values.html#276" class="Bound">k</a> <a id="278" class="Symbol">:</a> <a id="280" href="Agda.Builtin.Nat.html#%E2%84%95" class="Datatype">ℕ</a><a id="281" class="Symbol">)</a> <a id="283" class="Keyword">where</a>

<a id="290" class="Keyword">open</a> <a id="295" class="Keyword">import</a> <a id="302" href="MJSF.Syntax.html" class="Module">MJSF.Syntax</a> <a id="314" href="MJSF.Values.html#276" class="Bound">k</a>
<a id="316" class="Keyword">open</a> <a id="321" class="Keyword">import</a> <a id="328" href="ScopesFrames.ScopesFrames.html" class="Module">ScopesFrames.ScopesFrames</a> <a id="354" href="MJSF.Values.html#276" class="Bound">k</a> <a id="356" href="MJSF.Syntax.html#1183" class="Datatype">Ty</a>

<a id="360" class="Keyword">module</a> <a id="ValuesG" href="MJSF.Values.html#ValuesG" class="Module">ValuesG</a> <a id="375" class="Symbol">(</a><a id="376" href="MJSF.Values.html#376" class="Bound">g</a> <a id="378" class="Symbol">:</a> <a id="380" href="ScopesFrames.ScopesFrames.html#1611" class="Function">Graph</a><a id="385" class="Symbol">)</a> <a id="387" class="Keyword">where</a>

  <a id="396" class="Keyword">open</a> <a id="401" href="MJSF.Syntax.html#SyntaxG" class="Module">SyntaxG</a> <a id="409" href="MJSF.Values.html#376" class="Bound">g</a>
  <a id="413" class="Keyword">open</a> <a id="418" href="ScopesFrames.ScopesFrames.html#UsesGraph" class="Module">UsesGraph</a> <a id="428" href="MJSF.Values.html#376" class="Bound">g</a> <a id="430" class="Keyword">public</a>
  <a id="439" class="Keyword">open</a> <a id="444" class="Keyword">import</a> <a id="451" href="Common.Weakening.html" class="Module">Common.Weakening</a>

  <a id="471" class="Comment">------------</a>
  <a id="486" class="Comment">-- VALUES --</a>
  <a id="501" class="Comment">------------</a>

  <a id="517" class="Comment">-- The values used in our interpreter at run time are either:</a>
  <a id="581" class="Comment">--</a>
  <a id="586" class="Comment">-- * object references `ref`, represented in terms of a frame scoped</a>
  <a id="657" class="Comment">--   by a class scope;</a>
  <a id="682" class="Comment">--</a>
  <a id="687" class="Comment">-- * null values (`ref` typed);</a>
  <a id="721" class="Comment">--</a>
  <a id="726" class="Comment">-- * an integer number literal (`int` typed); or</a>
  <a id="777" class="Comment">--</a>
  <a id="782" class="Comment">-- * `void` (`void typed -- note that there is no expression syntax</a>
  <a id="852" class="Comment">--   for producing a `void` value directly, but method bodies still</a>
  <a id="922" class="Comment">--   return `void`; we regard `void` as a unit type)</a>

  <a id="978" class="Keyword">data</a> <a id="ValuesG.Val" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="987" class="Symbol">:</a> <a id="989" href="MJSF.Syntax.html#731" class="Datatype">VTy</a> <a id="993" class="Symbol">→</a> <a id="995" href="Agda.Builtin.List.html#List" class="Datatype">List</a> <a id="1000" href="ScopesFrames.ScopesFrames.html#1597" class="Function">Scope</a> <a id="1006" class="Symbol">→</a> <a id="1008" class="PrimitiveType">Set</a> <a id="1012" class="Keyword">where</a>
    <a id="ValuesG.Val.ref" href="MJSF.Values.html#ValuesG.Val.ref" class="InductiveConstructor">ref</a>    <a id="1029" class="Symbol">:</a>  <a id="1032" class="Symbol">∀</a> <a id="1034" class="Symbol">{</a><a id="1035" href="MJSF.Values.html#1035" class="Bound">s</a> <a id="1037" href="MJSF.Values.html#1037" class="Bound">s&#39;</a> <a id="1040" href="MJSF.Values.html#1040" class="Bound">Σ</a><a id="1041" class="Symbol">}</a> <a id="1043" class="Symbol">→</a> <a id="1045" href="MJSF.Values.html#1035" class="Bound">s</a> <a id="1047" href="MJSF.Syntax.html#2588" class="Function Operator">&lt;:</a> <a id="1050" href="MJSF.Values.html#1037" class="Bound">s&#39;</a> <a id="1053" class="Symbol">→</a> <a id="1055" href="ScopesFrames.ScopesFrames.html#3004" class="Function">Frame</a> <a id="1061" href="MJSF.Values.html#1035" class="Bound">s</a> <a id="1063" href="MJSF.Values.html#1040" class="Bound">Σ</a> <a id="1065" class="Symbol">→</a> <a id="1067" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="1071" class="Symbol">(</a><a id="1072" href="MJSF.Syntax.html#774" class="InductiveConstructor">ref</a> <a id="1076" href="MJSF.Values.html#1037" class="Bound">s&#39;</a><a id="1078" class="Symbol">)</a> <a id="1080" href="MJSF.Values.html#1040" class="Bound">Σ</a>
    <a id="ValuesG.Val.null" href="MJSF.Values.html#ValuesG.Val.null" class="InductiveConstructor">null</a>   <a id="1093" class="Symbol">:</a>  <a id="1096" class="Symbol">∀</a> <a id="1098" class="Symbol">{</a><a id="1099" href="MJSF.Values.html#1099" class="Bound">s</a> <a id="1101" href="MJSF.Values.html#1101" class="Bound">Σ</a><a id="1102" class="Symbol">}</a> <a id="1104" class="Symbol">→</a> <a id="1106" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="1110" class="Symbol">(</a><a id="1111" href="MJSF.Syntax.html#774" class="InductiveConstructor">ref</a> <a id="1115" href="MJSF.Values.html#1099" class="Bound">s</a><a id="1116" class="Symbol">)</a> <a id="1118" href="MJSF.Values.html#1101" class="Bound">Σ</a>
    <a id="ValuesG.Val.num" href="MJSF.Values.html#ValuesG.Val.num" class="InductiveConstructor">num</a>    <a id="1131" class="Symbol">:</a>  <a id="1134" class="Symbol">∀</a> <a id="1136" class="Symbol">{</a><a id="1137" href="MJSF.Values.html#1137" class="Bound">Σ</a><a id="1138" class="Symbol">}</a> <a id="1140" class="Symbol">→</a> <a id="1142" href="Agda.Builtin.Int.html#%E2%84%A4" class="Datatype">ℤ</a> <a id="1144" class="Symbol">→</a> <a id="1146" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="1150" href="MJSF.Syntax.html#762" class="InductiveConstructor">int</a> <a id="1154" href="MJSF.Values.html#1137" class="Bound">Σ</a>
    <a id="ValuesG.Val.void" href="MJSF.Values.html#ValuesG.Val.void" class="InductiveConstructor">void</a>   <a id="1167" class="Symbol">:</a>  <a id="1170" class="Symbol">∀</a> <a id="1172" class="Symbol">{</a><a id="1173" href="MJSF.Values.html#1173" class="Bound">Σ</a><a id="1174" class="Symbol">}</a> <a id="1176" class="Symbol">→</a> <a id="1178" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="1182" href="MJSF.Syntax.html#749" class="InductiveConstructor">void</a> <a id="1187" href="MJSF.Values.html#1173" class="Bound">Σ</a>

  <a id="1192" class="Comment">-- There are three kinds of values stored in frame slots at run</a>
  <a id="1258" class="Comment">-- time, corresponding to each of the three kinds of declarations</a>
  <a id="1326" class="Comment">-- defined in `MJSF.Syntax`:</a>
  <a id="1357" class="Comment">--</a>
  <a id="1362" class="Comment">-- * values, as defined above;</a>
  <a id="1395" class="Comment">--</a>
  <a id="1400" class="Comment">-- * methods, where a method records a &quot;self&quot; frame `Frame s Σ` and</a>
  <a id="1470" class="Comment">--   a well-typed method definition `Meth s ts rt`, such that the</a>
  <a id="1538" class="Comment">--   scope of the method corresponds to the &quot;self&quot;; and</a>
  <a id="1596" class="Comment">--</a>
  <a id="1601" class="Comment">-- * classes which record a well-typed class definition and a</a>
  <a id="1665" class="Comment">--   witness that the class has a finite inheritance chain, both</a>
  <a id="1732" class="Comment">--   used for initializing new object instances, as well as a frame</a>
  <a id="1802" class="Comment">--   pointer to the root frame (class table).</a>

  <a id="1851" class="Keyword">data</a> <a id="ValuesG.Valᵗ" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="1861" class="Symbol">:</a> <a id="1863" href="MJSF.Syntax.html#1183" class="Datatype">Ty</a> <a id="1866" class="Symbol">→</a> <a id="1868" href="Agda.Builtin.List.html#List" class="Datatype">List</a> <a id="1873" href="ScopesFrames.ScopesFrames.html#1597" class="Function">Scope</a> <a id="1879" class="Symbol">→</a> <a id="1881" class="PrimitiveType">Set</a> <a id="1885" class="Keyword">where</a>
    <a id="ValuesG.Valᵗ.vᵗ" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.v%E1%B5%97" class="InductiveConstructor">vᵗ</a> <a id="1898" class="Symbol">:</a> <a id="1900" class="Symbol">∀</a> <a id="1902" class="Symbol">{</a><a id="1903" href="MJSF.Values.html#1903" class="Bound">t</a> <a id="1905" href="MJSF.Values.html#1905" class="Bound">Σ</a><a id="1906" class="Symbol">}</a> <a id="1908" class="Symbol">→</a> <a id="1910" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="1914" href="MJSF.Values.html#1903" class="Bound">t</a> <a id="1916" href="MJSF.Values.html#1905" class="Bound">Σ</a> <a id="1918" class="Symbol">→</a> <a id="1920" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="1925" class="Symbol">(</a><a id="1926" href="MJSF.Syntax.html#1200" class="InductiveConstructor">vᵗ</a> <a id="1929" href="MJSF.Values.html#1903" class="Bound">t</a><a id="1930" class="Symbol">)</a> <a id="1932" href="MJSF.Values.html#1905" class="Bound">Σ</a>
    <a id="ValuesG.Valᵗ.mᵗ" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.m%E1%B5%97" class="InductiveConstructor">mᵗ</a> <a id="1941" class="Symbol">:</a> <a id="1943" class="Symbol">∀</a> <a id="1945" class="Symbol">{</a><a id="1946" href="MJSF.Values.html#1946" class="Bound">s</a> <a id="1948" href="MJSF.Values.html#1948" class="Bound">ts</a> <a id="1951" href="MJSF.Values.html#1951" class="Bound">rt</a> <a id="1954" href="MJSF.Values.html#1954" class="Bound">Σ</a><a id="1955" class="Symbol">}</a> <a id="1957" class="Symbol">→</a> <a id="1959" class="Symbol">(</a><a id="1960" href="MJSF.Values.html#1960" class="Bound">self</a> <a id="1965" class="Symbol">:</a> <a id="1967" href="ScopesFrames.ScopesFrames.html#3004" class="Function">Frame</a> <a id="1973" href="MJSF.Values.html#1946" class="Bound">s</a> <a id="1975" href="MJSF.Values.html#1954" class="Bound">Σ</a><a id="1976" class="Symbol">)</a> <a id="1978" class="Symbol">→</a> <a id="1980" class="Symbol">(</a><a id="1981" href="MJSF.Values.html#1981" class="Bound">body</a> <a id="1986" class="Symbol">:</a> <a id="1988" href="MJSF.Syntax.html#5907" class="Datatype">Meth</a> <a id="1993" href="MJSF.Values.html#1946" class="Bound">s</a> <a id="1995" href="MJSF.Values.html#1948" class="Bound">ts</a> <a id="1998" href="MJSF.Values.html#1951" class="Bound">rt</a><a id="2000" class="Symbol">)</a> <a id="2002" class="Symbol">→</a> <a id="2004" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="2009" class="Symbol">(</a><a id="2010" href="MJSF.Syntax.html#1216" class="InductiveConstructor">mᵗ</a> <a id="2013" href="MJSF.Values.html#1948" class="Bound">ts</a> <a id="2016" href="MJSF.Values.html#1951" class="Bound">rt</a><a id="2018" class="Symbol">)</a> <a id="2020" href="MJSF.Values.html#1954" class="Bound">Σ</a>
    <a id="ValuesG.Valᵗ.cᵗ" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.c%E1%B5%97" class="InductiveConstructor">cᵗ</a> <a id="2029" class="Symbol">:</a> <a id="2031" class="Symbol">∀</a> <a id="2033" class="Symbol">{</a><a id="2034" href="MJSF.Values.html#2034" class="Bound">sʳ</a> <a id="2037" href="MJSF.Values.html#2037" class="Bound">s</a> <a id="2039" href="MJSF.Values.html#2039" class="Bound">s&#39;</a> <a id="2042" href="MJSF.Values.html#2042" class="Bound">Σ</a><a id="2043" class="Symbol">}</a> <a id="2045" class="Symbol">→</a> <a id="2047" class="Symbol">(</a><a id="2048" href="MJSF.Values.html#2048" class="Bound">class-def</a> <a id="2058" class="Symbol">:</a> <a id="2060" href="MJSF.Syntax.html#7044" class="Datatype">Class</a> <a id="2066" href="MJSF.Values.html#2034" class="Bound">sʳ</a> <a id="2069" href="MJSF.Values.html#2037" class="Bound">s</a><a id="2070" class="Symbol">)</a> <a id="2072" class="Symbol">→</a> <a id="2074" class="Symbol">(</a><a id="2075" href="MJSF.Values.html#2075" class="Bound">ic</a> <a id="2078" class="Symbol">:</a> <a id="2080" href="MJSF.Syntax.html#3102" class="Datatype">Inherits</a> <a id="2089" href="MJSF.Values.html#2037" class="Bound">s</a> <a id="2091" href="MJSF.Values.html#2039" class="Bound">s&#39;</a><a id="2093" class="Symbol">)</a> <a id="2095" class="Symbol">→</a> <a id="2097" class="Symbol">(</a><a id="2098" href="MJSF.Values.html#2098" class="Bound">root</a> <a id="2103" class="Symbol">:</a> <a id="2105" href="ScopesFrames.ScopesFrames.html#3004" class="Function">Frame</a> <a id="2111" href="MJSF.Values.html#2034" class="Bound">sʳ</a> <a id="2114" href="MJSF.Values.html#2042" class="Bound">Σ</a><a id="2115" class="Symbol">)</a> <a id="2117" class="Symbol">→</a> <a id="2119" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="2124" class="Symbol">(</a><a id="2125" href="MJSF.Syntax.html#1243" class="InductiveConstructor">cᵗ</a> <a id="2128" href="MJSF.Values.html#2034" class="Bound">sʳ</a> <a id="2131" href="MJSF.Values.html#2037" class="Bound">s</a><a id="2132" class="Symbol">)</a> <a id="2134" href="MJSF.Values.html#2042" class="Bound">Σ</a>


  <a id="2140" class="Comment">---------------</a>
  <a id="2158" class="Comment">-- WEAKENING --</a>
  <a id="2176" class="Comment">---------------</a>

  <a id="2195" class="Comment">-- We define notions of weakening for each of the values summarized above:</a>

  <a id="ValuesG.val-weaken" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a>    <a id="2287" class="Symbol">:</a>  <a id="2290" class="Symbol">∀</a> <a id="2292" class="Symbol">{</a><a id="2293" href="MJSF.Values.html#2293" class="Bound">t</a> <a id="2295" href="MJSF.Values.html#2295" class="Bound">Σ</a> <a id="2297" href="MJSF.Values.html#2297" class="Bound">Σ&#39;</a><a id="2299" class="Symbol">}</a> <a id="2301" class="Symbol">→</a> <a id="2303" href="MJSF.Values.html#2295" class="Bound">Σ</a> <a id="2305" href="Data.List.Prefix.html#_%E2%8A%91_" class="Datatype Operator">⊑</a> <a id="2307" href="MJSF.Values.html#2297" class="Bound">Σ&#39;</a> <a id="2310" class="Symbol">→</a> <a id="2312" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="2316" href="MJSF.Values.html#2293" class="Bound">t</a> <a id="2318" href="MJSF.Values.html#2295" class="Bound">Σ</a> <a id="2320" class="Symbol">→</a> <a id="2322" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="2326" href="MJSF.Values.html#2293" class="Bound">t</a> <a id="2328" href="MJSF.Values.html#2297" class="Bound">Σ&#39;</a>
  <a id="2333" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a> <a id="2344" href="MJSF.Values.html#2344" class="Bound">ext</a> <a id="2348" class="Symbol">(</a><a id="2349" href="MJSF.Values.html#ValuesG.Val.num" class="InductiveConstructor">num</a> <a id="2353" href="MJSF.Values.html#2353" class="Bound">i</a><a id="2354" class="Symbol">)</a>  <a id="2357" class="Symbol">=</a>  <a id="2360" href="MJSF.Values.html#ValuesG.Val.num" class="InductiveConstructor">num</a> <a id="2364" href="MJSF.Values.html#2353" class="Bound">i</a>
  <a id="2368" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a> <a id="2379" href="MJSF.Values.html#2379" class="Bound">ext</a> <a id="2383" class="Symbol">(</a><a id="2384" href="MJSF.Values.html#ValuesG.Val.ref" class="InductiveConstructor">ref</a> <a id="2388" href="MJSF.Values.html#2388" class="Bound">i</a> <a id="2390" href="MJSF.Values.html#2390" class="Bound">f</a><a id="2391" class="Symbol">)</a>  <a id="2394" class="Symbol">=</a>  <a id="2397" href="MJSF.Values.html#ValuesG.Val.ref" class="InductiveConstructor">ref</a> <a id="2401" href="MJSF.Values.html#2388" class="Bound">i</a> <a id="2403" class="Symbol">(</a><a id="2404" href="Common.Weakening.html#746" class="Field">wk</a> <a id="2407" href="MJSF.Values.html#2379" class="Bound">ext</a> <a id="2411" href="MJSF.Values.html#2390" class="Bound">f</a><a id="2412" class="Symbol">)</a>
  <a id="2416" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a> <a id="2427" href="MJSF.Values.html#2427" class="Bound">ext</a> <a id="2431" href="MJSF.Values.html#ValuesG.Val.null" class="InductiveConstructor">null</a>     <a id="2440" class="Symbol">=</a>  <a id="2443" href="MJSF.Values.html#ValuesG.Val.null" class="InductiveConstructor">null</a>
  <a id="2450" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a> <a id="2461" href="MJSF.Values.html#2461" class="Bound">ext</a> <a id="2465" href="MJSF.Values.html#ValuesG.Val.void" class="InductiveConstructor">void</a>     <a id="2474" class="Symbol">=</a>  <a id="2477" href="MJSF.Values.html#ValuesG.Val.void" class="InductiveConstructor">void</a>

  <a id="2485" class="Keyword">instance</a>
    <a id="ValuesG.val-weakenable" href="MJSF.Values.html#ValuesG.val-weakenable" class="Function">val-weakenable</a> <a id="2513" class="Symbol">:</a> <a id="2515" class="Symbol">∀</a> <a id="2517" class="Symbol">{</a><a id="2518" href="MJSF.Values.html#2518" class="Bound">t</a><a id="2519" class="Symbol">}</a> <a id="2521" class="Symbol">→</a> <a id="2523" href="Common.Weakening.html#Weakenable" class="Record">Weakenable</a> <a id="2534" class="Symbol">(</a><a id="2535" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="2539" href="MJSF.Values.html#2518" class="Bound">t</a><a id="2540" class="Symbol">)</a>
    <a id="2546" href="MJSF.Values.html#ValuesG.val-weakenable" class="Function">val-weakenable</a> <a id="2561" class="Symbol">=</a> <a id="2563" class="Keyword">record</a> <a id="2570" class="Symbol">{</a> <a id="2572" class="Field">wk</a> <a id="2575" class="Symbol">=</a> <a id="2577" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a> <a id="2588" class="Symbol">}</a>

  <a id="ValuesG.valᵗ-weaken" href="MJSF.Values.html#ValuesG.val%E1%B5%97-weaken" class="Function">valᵗ-weaken</a> <a id="2605" class="Symbol">:</a> <a id="2607" class="Symbol">∀</a> <a id="2609" class="Symbol">{</a><a id="2610" href="MJSF.Values.html#2610" class="Bound">t</a> <a id="2612" href="MJSF.Values.html#2612" class="Bound">Σ</a> <a id="2614" href="MJSF.Values.html#2614" class="Bound">Σ&#39;</a><a id="2616" class="Symbol">}</a> <a id="2618" class="Symbol">→</a> <a id="2620" href="MJSF.Values.html#2612" class="Bound">Σ</a> <a id="2622" href="Data.List.Prefix.html#_%E2%8A%91_" class="Datatype Operator">⊑</a> <a id="2624" href="MJSF.Values.html#2614" class="Bound">Σ&#39;</a> <a id="2627" class="Symbol">→</a> <a id="2629" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="2634" href="MJSF.Values.html#2610" class="Bound">t</a> <a id="2636" href="MJSF.Values.html#2612" class="Bound">Σ</a> <a id="2638" class="Symbol">→</a> <a id="2640" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="2645" href="MJSF.Values.html#2610" class="Bound">t</a> <a id="2647" href="MJSF.Values.html#2614" class="Bound">Σ&#39;</a>
  <a id="2652" href="MJSF.Values.html#ValuesG.val%E1%B5%97-weaken" class="Function">valᵗ-weaken</a> <a id="2664" href="MJSF.Values.html#2664" class="Bound">ext</a> <a id="2668" class="Symbol">(</a><a id="2669" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.v%E1%B5%97" class="InductiveConstructor">vᵗ</a> <a id="2672" href="MJSF.Values.html#2672" class="Bound">v</a><a id="2673" class="Symbol">)</a>      <a id="2680" class="Symbol">=</a> <a id="2682" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.v%E1%B5%97" class="InductiveConstructor">vᵗ</a> <a id="2685" class="Symbol">(</a><a id="2686" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a> <a id="2697" href="MJSF.Values.html#2664" class="Bound">ext</a> <a id="2701" href="MJSF.Values.html#2672" class="Bound">v</a><a id="2702" class="Symbol">)</a>
  <a id="2706" href="MJSF.Values.html#ValuesG.val%E1%B5%97-weaken" class="Function">valᵗ-weaken</a> <a id="2718" href="MJSF.Values.html#2718" class="Bound">ext</a> <a id="2722" class="Symbol">(</a><a id="2723" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.m%E1%B5%97" class="InductiveConstructor">mᵗ</a> <a id="2726" href="MJSF.Values.html#2726" class="Bound">f</a> <a id="2728" href="MJSF.Values.html#2728" class="Bound">m</a><a id="2729" class="Symbol">)</a>    <a id="2734" class="Symbol">=</a> <a id="2736" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.m%E1%B5%97" class="InductiveConstructor">mᵗ</a> <a id="2739" class="Symbol">(</a><a id="2740" href="Common.Weakening.html#746" class="Field">wk</a> <a id="2743" href="MJSF.Values.html#2718" class="Bound">ext</a> <a id="2747" href="MJSF.Values.html#2726" class="Bound">f</a><a id="2748" class="Symbol">)</a> <a id="2750" href="MJSF.Values.html#2728" class="Bound">m</a>
  <a id="2754" href="MJSF.Values.html#ValuesG.val%E1%B5%97-weaken" class="Function">valᵗ-weaken</a> <a id="2766" href="MJSF.Values.html#2766" class="Bound">ext</a> <a id="2770" class="Symbol">(</a><a id="2771" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.c%E1%B5%97" class="InductiveConstructor">cᵗ</a> <a id="2774" href="MJSF.Values.html#2774" class="Bound">c</a> <a id="2776" href="MJSF.Values.html#2776" class="Bound">ic</a> <a id="2779" href="MJSF.Values.html#2779" class="Bound">f</a><a id="2780" class="Symbol">)</a> <a id="2782" class="Symbol">=</a> <a id="2784" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.c%E1%B5%97" class="InductiveConstructor">cᵗ</a> <a id="2787" href="MJSF.Values.html#2774" class="Bound">c</a> <a id="2789" href="MJSF.Values.html#2776" class="Bound">ic</a> <a id="2792" class="Symbol">(</a><a id="2793" href="Common.Weakening.html#746" class="Field">wk</a> <a id="2796" href="MJSF.Values.html#2766" class="Bound">ext</a> <a id="2800" href="MJSF.Values.html#2779" class="Bound">f</a><a id="2801" class="Symbol">)</a>

  <a id="2806" class="Comment">-- And pass these to the scope graph definition:</a>

  <a id="2858" class="Keyword">open</a> <a id="2863" href="ScopesFrames.ScopesFrames.html#UsesVal" class="Module">UsesVal</a> <a id="2871" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="2876" href="MJSF.Values.html#ValuesG.val%E1%B5%97-weaken" class="Function">valᵗ-weaken</a> <a id="2888" class="Keyword">renaming</a> <a id="2897" class="Symbol">(</a>getFrame <a id="2907" class="Symbol">to</a> getFrame&#39;<a id="2919" class="Symbol">)</a>


  <a id="2925" class="Comment">--------------</a>
  <a id="2942" class="Comment">-- COERCION --</a>
  <a id="2959" class="Comment">--------------</a>

  <a id="2977" class="Comment">-- Our definition of sub-typing gives rise to a notion of sub-type</a>
  <a id="3046" class="Comment">-- coercion, defined below.  Coercions essentially traverse the</a>
  <a id="3112" class="Comment">-- inheritance links of the frame hierarchy for an object instance,</a>
  <a id="3182" class="Comment">-- as described in the paper.</a>

  <a id="ValuesG.upcastRef" href="MJSF.Values.html#ValuesG.upcastRef" class="Function">upcastRef</a> <a id="3225" class="Symbol">:</a> <a id="3227" class="Symbol">∀</a> <a id="3229" class="Symbol">{</a><a id="3230" href="MJSF.Values.html#3230" class="Bound">t</a> <a id="3232" href="MJSF.Values.html#3232" class="Bound">t&#39;</a> <a id="3235" href="MJSF.Values.html#3235" class="Bound">Σ</a><a id="3236" class="Symbol">}</a> <a id="3238" class="Symbol">→</a> <a id="3240" href="MJSF.Values.html#3230" class="Bound">t</a> <a id="3242" href="MJSF.Syntax.html#2588" class="Function Operator">&lt;:</a> <a id="3245" href="MJSF.Values.html#3232" class="Bound">t&#39;</a> <a id="3248" class="Symbol">→</a> <a id="3250" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="3254" class="Symbol">(</a><a id="3255" href="MJSF.Syntax.html#774" class="InductiveConstructor">ref</a> <a id="3259" href="MJSF.Values.html#3230" class="Bound">t</a><a id="3260" class="Symbol">)</a> <a id="3262" href="MJSF.Values.html#3235" class="Bound">Σ</a> <a id="3264" class="Symbol">→</a> <a id="3266" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="3270" class="Symbol">(</a><a id="3271" href="MJSF.Syntax.html#774" class="InductiveConstructor">ref</a> <a id="3275" href="MJSF.Values.html#3232" class="Bound">t&#39;</a><a id="3277" class="Symbol">)</a> <a id="3279" href="MJSF.Values.html#3235" class="Bound">Σ</a>
  <a id="3283" href="MJSF.Values.html#ValuesG.upcastRef" class="Function">upcastRef</a> <a id="3293" href="MJSF.Values.html#3293" class="Bound">i</a> <a id="3295" class="Symbol">(</a><a id="3296" href="MJSF.Values.html#ValuesG.Val.ref" class="InductiveConstructor">ref</a> <a id="3300" href="MJSF.Values.html#3300" class="Bound">i&#39;</a> <a id="3303" href="MJSF.Values.html#3303" class="Bound">f</a><a id="3304" class="Symbol">)</a> <a id="3306" class="Symbol">=</a> <a id="3308" href="MJSF.Values.html#ValuesG.Val.ref" class="InductiveConstructor">ref</a> <a id="3312" class="Symbol">(</a><a id="3313" href="ScopesFrames.ScopesFrames.html#2221" class="Function">concatₚ</a> <a id="3321" href="MJSF.Values.html#3300" class="Bound">i&#39;</a> <a id="3324" href="MJSF.Values.html#3293" class="Bound">i</a><a id="3325" class="Symbol">)</a> <a id="3327" href="MJSF.Values.html#3303" class="Bound">f</a>
  <a id="3331" href="MJSF.Values.html#ValuesG.upcastRef" class="Function">upcastRef</a> <a id="3341" href="MJSF.Values.html#3341" class="Bound">i</a> <a id="3343" href="MJSF.Values.html#ValuesG.Val.null" class="InductiveConstructor">null</a> <a id="3348" class="Symbol">=</a> <a id="3350" href="MJSF.Values.html#ValuesG.Val.null" class="InductiveConstructor">null</a>
</pre></body></html>