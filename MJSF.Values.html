<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>MJSF.Values</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="22" class="Keyword">open</a> <a id="27" class="Keyword">import</a> <a id="34" href="Data.List.Most.html" class="Module">Data.List.Most</a>
<a id="49" class="Keyword">open</a> <a id="54" class="Keyword">import</a> <a id="61" href="Data.Integer.html" class="Module">Data.Integer</a>
<a id="74" class="Keyword">open</a> <a id="79" class="Keyword">import</a> <a id="86" href="Data.Product.html" class="Module">Data.Product</a>

<a id="100" class="Comment">-- This file contains the definition of values for the definitional</a>
<a id="168" class="Comment">-- interpreter for MJ using scopes and frames, described in Section 5</a>
<a id="238" class="Comment">-- of the paper.</a>

<a id="256" class="Keyword">module</a> <a id="263" href="MJSF.Values.html" class="Module">MJSF.Values</a> <a id="275" class="Symbol">(</a><a id="276" href="MJSF.Values.html#276" class="Bound">k</a> <a id="278" class="Symbol">:</a> <a id="280" href="Agda.Builtin.Nat.html#%E2%84%95" class="Datatype">ℕ</a><a id="281" class="Symbol">)</a> <a id="283" class="Keyword">where</a>

<a id="290" class="Keyword">open</a> <a id="295" class="Keyword">import</a> <a id="302" href="MJSF.Syntax.html" class="Module">MJSF.Syntax</a> <a id="314" href="MJSF.Values.html#276" class="Bound">k</a>
<a id="316" class="Keyword">open</a> <a id="321" class="Keyword">import</a> <a id="328" href="ScopeGraph.ScopesFrames.html" class="Module">ScopeGraph.ScopesFrames</a> <a id="352" href="MJSF.Values.html#276" class="Bound">k</a> <a id="354" href="MJSF.Syntax.html#1183" class="Datatype">Ty</a>

<a id="358" class="Keyword">module</a> <a id="ValuesG" href="MJSF.Values.html#ValuesG" class="Module">ValuesG</a> <a id="373" class="Symbol">(</a><a id="374" href="MJSF.Values.html#374" class="Bound">g</a> <a id="376" class="Symbol">:</a> <a id="378" href="ScopeGraph.ScopesFrames.html#1637" class="Function">Graph</a><a id="383" class="Symbol">)</a> <a id="385" class="Keyword">where</a>

  <a id="394" class="Keyword">open</a> <a id="399" href="MJSF.Syntax.html#SyntaxG" class="Module">SyntaxG</a> <a id="407" href="MJSF.Values.html#374" class="Bound">g</a>
  <a id="411" class="Keyword">open</a> <a id="416" href="ScopeGraph.ScopesFrames.html#UsesGraph" class="Module">UsesGraph</a> <a id="426" href="MJSF.Values.html#374" class="Bound">g</a> <a id="428" class="Keyword">public</a>
  <a id="437" class="Keyword">open</a> <a id="442" class="Keyword">import</a> <a id="449" href="Common.Weakening.html" class="Module">Common.Weakening</a>
  <a id="468" class="Keyword">open</a> <a id="473" href="Common.Weakening.html#Weakenable" class="Module">Weakenable</a> <a id="484" class="Symbol">⦃...⦄</a>

  <a id="493" class="Comment">------------</a>
  <a id="508" class="Comment">-- VALUES --</a>
  <a id="523" class="Comment">------------</a>

  <a id="539" class="Comment">-- The values used in our interpreter at run time are either:</a>
  <a id="603" class="Comment">--</a>
  <a id="608" class="Comment">-- * object references `ref`, represented in terms of a frame scoped</a>
  <a id="679" class="Comment">--   by a class scope;</a>
  <a id="704" class="Comment">--</a>
  <a id="709" class="Comment">-- * null values (`ref` typed);</a>
  <a id="743" class="Comment">--</a>
  <a id="748" class="Comment">-- * an integer number literal (`int` typed); or</a>
  <a id="799" class="Comment">--</a>
  <a id="804" class="Comment">-- * `void` (`void typed -- note that there is no expression syntax</a>
  <a id="874" class="Comment">--   for producing a `void` value directly, but method bodies still</a>
  <a id="944" class="Comment">--   return `void`; we regard `void` as a unit type)</a>

  <a id="1000" class="Keyword">data</a> <a id="ValuesG.Val" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="1009" class="Symbol">:</a> <a id="1011" href="MJSF.Syntax.html#731" class="Datatype">VTy</a> <a id="1015" class="Symbol">→</a> <a id="1017" href="Agda.Builtin.List.html#List" class="Datatype">List</a> <a id="1022" href="ScopeGraph.ScopesFrames.html#1623" class="Function">Scope</a> <a id="1028" class="Symbol">→</a> <a id="1030" class="PrimitiveType">Set</a> <a id="1034" class="Keyword">where</a>
    <a id="ValuesG.Val.ref" href="MJSF.Values.html#ValuesG.Val.ref" class="InductiveConstructor">ref</a>    <a id="1051" class="Symbol">:</a>  <a id="1054" class="Symbol">∀</a> <a id="1056" class="Symbol">{</a><a id="1057" href="MJSF.Values.html#1057" class="Bound">s</a> <a id="1059" href="MJSF.Values.html#1059" class="Bound">Σ</a><a id="1060" class="Symbol">}</a> <a id="1062" class="Symbol">→</a> <a id="1064" href="ScopeGraph.ScopesFrames.html#2789" class="Function">Frame</a> <a id="1070" href="MJSF.Values.html#1057" class="Bound">s</a> <a id="1072" href="MJSF.Values.html#1059" class="Bound">Σ</a> <a id="1074" class="Symbol">→</a> <a id="1076" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="1080" class="Symbol">(</a><a id="1081" href="MJSF.Syntax.html#774" class="InductiveConstructor">ref</a> <a id="1085" href="MJSF.Values.html#1057" class="Bound">s</a><a id="1086" class="Symbol">)</a> <a id="1088" href="MJSF.Values.html#1059" class="Bound">Σ</a>
    <a id="ValuesG.Val.null" href="MJSF.Values.html#ValuesG.Val.null" class="InductiveConstructor">null</a>   <a id="1101" class="Symbol">:</a>  <a id="1104" class="Symbol">∀</a> <a id="1106" class="Symbol">{</a><a id="1107" href="MJSF.Values.html#1107" class="Bound">s</a> <a id="1109" href="MJSF.Values.html#1109" class="Bound">Σ</a><a id="1110" class="Symbol">}</a> <a id="1112" class="Symbol">→</a> <a id="1114" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="1118" class="Symbol">(</a><a id="1119" href="MJSF.Syntax.html#774" class="InductiveConstructor">ref</a> <a id="1123" href="MJSF.Values.html#1107" class="Bound">s</a><a id="1124" class="Symbol">)</a> <a id="1126" href="MJSF.Values.html#1109" class="Bound">Σ</a>
    <a id="ValuesG.Val.num" href="MJSF.Values.html#ValuesG.Val.num" class="InductiveConstructor">num</a>    <a id="1139" class="Symbol">:</a>  <a id="1142" class="Symbol">∀</a> <a id="1144" class="Symbol">{</a><a id="1145" href="MJSF.Values.html#1145" class="Bound">Σ</a><a id="1146" class="Symbol">}</a> <a id="1148" class="Symbol">→</a> <a id="1150" href="Agda.Builtin.Int.html#%E2%84%A4" class="Datatype">ℤ</a> <a id="1152" class="Symbol">→</a> <a id="1154" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="1158" href="MJSF.Syntax.html#762" class="InductiveConstructor">int</a> <a id="1162" href="MJSF.Values.html#1145" class="Bound">Σ</a>
    <a id="ValuesG.Val.void" href="MJSF.Values.html#ValuesG.Val.void" class="InductiveConstructor">void</a>   <a id="1175" class="Symbol">:</a>  <a id="1178" class="Symbol">∀</a> <a id="1180" class="Symbol">{</a><a id="1181" href="MJSF.Values.html#1181" class="Bound">Σ</a><a id="1182" class="Symbol">}</a> <a id="1184" class="Symbol">→</a> <a id="1186" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="1190" href="MJSF.Syntax.html#749" class="InductiveConstructor">void</a> <a id="1195" href="MJSF.Values.html#1181" class="Bound">Σ</a>

  <a id="1200" class="Comment">-- There are three kinds of values stored in frame slots at run</a>
  <a id="1266" class="Comment">-- time, corresponding to each of the three kinds of declarations</a>
  <a id="1334" class="Comment">-- defined in `MJSF.Syntax`:</a>
  <a id="1365" class="Comment">--</a>
  <a id="1370" class="Comment">-- * values, as defined above;</a>
  <a id="1403" class="Comment">--</a>
  <a id="1408" class="Comment">-- * methods, where a method records a &quot;self&quot; frame `Frame s Σ` and</a>
  <a id="1478" class="Comment">--   a well-typed method definition `Meth s ts rt`, such that the</a>
  <a id="1546" class="Comment">--   scope of the method corresponds to the &quot;self&quot;; and</a>
  <a id="1604" class="Comment">--</a>
  <a id="1609" class="Comment">-- * classes which record a well-typed class definition and a</a>
  <a id="1673" class="Comment">--   witness that the class has a finite inheritance chain, both</a>
  <a id="1740" class="Comment">--   used for initializing new object instances.</a>

  <a id="1792" class="Keyword">data</a> <a id="ValuesG.Valᵗ" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="1802" class="Symbol">:</a> <a id="1804" href="MJSF.Syntax.html#1183" class="Datatype">Ty</a> <a id="1807" class="Symbol">→</a> <a id="1809" href="Agda.Builtin.List.html#List" class="Datatype">List</a> <a id="1814" href="ScopeGraph.ScopesFrames.html#1623" class="Function">Scope</a> <a id="1820" class="Symbol">→</a> <a id="1822" class="PrimitiveType">Set</a> <a id="1826" class="Keyword">where</a>
    <a id="ValuesG.Valᵗ.vᵗ" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.v%E1%B5%97" class="InductiveConstructor">vᵗ</a> <a id="1839" class="Symbol">:</a> <a id="1841" class="Symbol">∀</a> <a id="1843" class="Symbol">{</a><a id="1844" href="MJSF.Values.html#1844" class="Bound">t</a> <a id="1846" href="MJSF.Values.html#1846" class="Bound">Σ</a><a id="1847" class="Symbol">}</a> <a id="1849" class="Symbol">→</a> <a id="1851" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="1855" href="MJSF.Values.html#1844" class="Bound">t</a> <a id="1857" href="MJSF.Values.html#1846" class="Bound">Σ</a> <a id="1859" class="Symbol">→</a> <a id="1861" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="1866" class="Symbol">(</a><a id="1867" href="MJSF.Syntax.html#1200" class="InductiveConstructor">vᵗ</a> <a id="1870" href="MJSF.Values.html#1844" class="Bound">t</a><a id="1871" class="Symbol">)</a> <a id="1873" href="MJSF.Values.html#1846" class="Bound">Σ</a>
    <a id="ValuesG.Valᵗ.mᵗ" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.m%E1%B5%97" class="InductiveConstructor">mᵗ</a> <a id="1882" class="Symbol">:</a> <a id="1884" class="Symbol">∀</a> <a id="1886" class="Symbol">{</a><a id="1887" href="MJSF.Values.html#1887" class="Bound">s</a> <a id="1889" href="MJSF.Values.html#1889" class="Bound">ts</a> <a id="1892" href="MJSF.Values.html#1892" class="Bound">rt</a> <a id="1895" href="MJSF.Values.html#1895" class="Bound">Σ</a><a id="1896" class="Symbol">}</a> <a id="1898" class="Symbol">→</a> <a id="1900" href="ScopeGraph.ScopesFrames.html#2789" class="Function">Frame</a> <a id="1906" href="MJSF.Values.html#1887" class="Bound">s</a> <a id="1908" href="MJSF.Values.html#1895" class="Bound">Σ</a> <a id="1910" class="Symbol">→</a> <a id="1912" href="MJSF.Syntax.html#6010" class="Datatype">Meth</a> <a id="1917" href="MJSF.Values.html#1887" class="Bound">s</a> <a id="1919" href="MJSF.Values.html#1889" class="Bound">ts</a> <a id="1922" href="MJSF.Values.html#1892" class="Bound">rt</a> <a id="1925" class="Symbol">→</a> <a id="1927" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="1932" class="Symbol">(</a><a id="1933" href="MJSF.Syntax.html#1216" class="InductiveConstructor">mᵗ</a> <a id="1936" href="MJSF.Values.html#1889" class="Bound">ts</a> <a id="1939" href="MJSF.Values.html#1892" class="Bound">rt</a><a id="1941" class="Symbol">)</a> <a id="1943" href="MJSF.Values.html#1895" class="Bound">Σ</a>
    <a id="ValuesG.Valᵗ.cᵗ" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.c%E1%B5%97" class="InductiveConstructor">cᵗ</a> <a id="1952" class="Symbol">:</a> <a id="1954" class="Symbol">∀</a> <a id="1956" class="Symbol">{</a><a id="1957" href="MJSF.Values.html#1957" class="Bound">sʳ</a> <a id="1960" href="MJSF.Values.html#1960" class="Bound">s</a> <a id="1962" href="MJSF.Values.html#1962" class="Bound">s&#39;</a> <a id="1965" href="MJSF.Values.html#1965" class="Bound">Σ</a><a id="1966" class="Symbol">}</a> <a id="1968" class="Symbol">→</a> <a id="1970" href="MJSF.Syntax.html#7147" class="Datatype">Class</a> <a id="1976" href="MJSF.Values.html#1957" class="Bound">sʳ</a> <a id="1979" href="MJSF.Values.html#1960" class="Bound">s</a> <a id="1981" class="Symbol">→</a> <a id="1983" href="MJSF.Syntax.html#3215" class="Datatype">Inherits</a> <a id="1992" href="MJSF.Values.html#1960" class="Bound">s</a> <a id="1994" href="MJSF.Values.html#1962" class="Bound">s&#39;</a> <a id="1997" class="Symbol">→</a> <a id="1999" href="ScopeGraph.ScopesFrames.html#2789" class="Function">Frame</a> <a id="2005" href="MJSF.Values.html#1957" class="Bound">sʳ</a> <a id="2008" href="MJSF.Values.html#1965" class="Bound">Σ</a> <a id="2010" class="Symbol">→</a> <a id="2012" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="2017" class="Symbol">(</a><a id="2018" href="MJSF.Syntax.html#1243" class="InductiveConstructor">cᵗ</a> <a id="2021" href="MJSF.Values.html#1957" class="Bound">sʳ</a> <a id="2024" href="MJSF.Values.html#1960" class="Bound">s</a><a id="2025" class="Symbol">)</a> <a id="2027" href="MJSF.Values.html#1965" class="Bound">Σ</a>


  <a id="2033" class="Comment">---------------</a>
  <a id="2051" class="Comment">-- WEAKENING --</a>
  <a id="2069" class="Comment">---------------</a>

  <a id="2088" class="Comment">-- We define notions of weakening for each of the values summarized above:</a>

  <a id="ValuesG.val-weaken" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a>    <a id="2180" class="Symbol">:</a>  <a id="2183" class="Symbol">∀</a> <a id="2185" class="Symbol">{</a><a id="2186" href="MJSF.Values.html#2186" class="Bound">t</a> <a id="2188" href="MJSF.Values.html#2188" class="Bound">Σ</a> <a id="2190" href="MJSF.Values.html#2190" class="Bound">Σ&#39;</a><a id="2192" class="Symbol">}</a> <a id="2194" class="Symbol">→</a> <a id="2196" href="MJSF.Values.html#2188" class="Bound">Σ</a> <a id="2198" href="Data.List.Prefix.html#_%E2%8A%91_" class="Datatype Operator">⊑</a> <a id="2200" href="MJSF.Values.html#2190" class="Bound">Σ&#39;</a> <a id="2203" class="Symbol">→</a> <a id="2205" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="2209" href="MJSF.Values.html#2186" class="Bound">t</a> <a id="2211" href="MJSF.Values.html#2188" class="Bound">Σ</a> <a id="2213" class="Symbol">→</a> <a id="2215" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="2219" href="MJSF.Values.html#2186" class="Bound">t</a> <a id="2221" href="MJSF.Values.html#2190" class="Bound">Σ&#39;</a>
  <a id="2226" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a> <a id="2237" href="MJSF.Values.html#2237" class="Bound">ext</a> <a id="2241" class="Symbol">(</a><a id="2242" href="MJSF.Values.html#ValuesG.Val.num" class="InductiveConstructor">num</a> <a id="2246" href="MJSF.Values.html#2246" class="Bound">i</a><a id="2247" class="Symbol">)</a>  <a id="2250" class="Symbol">=</a>  <a id="2253" href="MJSF.Values.html#ValuesG.Val.num" class="InductiveConstructor">num</a> <a id="2257" href="MJSF.Values.html#2246" class="Bound">i</a>
  <a id="2261" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a> <a id="2272" href="MJSF.Values.html#2272" class="Bound">ext</a> <a id="2276" class="Symbol">(</a><a id="2277" href="MJSF.Values.html#ValuesG.Val.ref" class="InductiveConstructor">ref</a> <a id="2281" href="MJSF.Values.html#2281" class="Bound">f</a><a id="2282" class="Symbol">)</a>  <a id="2285" class="Symbol">=</a>  <a id="2288" href="MJSF.Values.html#ValuesG.Val.ref" class="InductiveConstructor">ref</a> <a id="2292" class="Symbol">(</a><a id="2293" href="Common.Weakening.html#228" class="Field">wk</a> <a id="2296" href="MJSF.Values.html#2272" class="Bound">ext</a> <a id="2300" href="MJSF.Values.html#2281" class="Bound">f</a><a id="2301" class="Symbol">)</a>
  <a id="2305" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a> <a id="2316" href="MJSF.Values.html#2316" class="Bound">ext</a> <a id="2320" href="MJSF.Values.html#ValuesG.Val.null" class="InductiveConstructor">null</a>     <a id="2329" class="Symbol">=</a>  <a id="2332" href="MJSF.Values.html#ValuesG.Val.null" class="InductiveConstructor">null</a>
  <a id="2339" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a> <a id="2350" href="MJSF.Values.html#2350" class="Bound">ext</a> <a id="2354" href="MJSF.Values.html#ValuesG.Val.void" class="InductiveConstructor">void</a>     <a id="2363" class="Symbol">=</a>  <a id="2366" href="MJSF.Values.html#ValuesG.Val.void" class="InductiveConstructor">void</a>

  <a id="2374" class="Keyword">instance</a>
    <a id="ValuesG.val-weakenable" href="MJSF.Values.html#ValuesG.val-weakenable" class="Function">val-weakenable</a> <a id="2402" class="Symbol">:</a> <a id="2404" class="Symbol">∀</a> <a id="2406" class="Symbol">{</a><a id="2407" href="MJSF.Values.html#2407" class="Bound">t</a><a id="2408" class="Symbol">}</a> <a id="2410" class="Symbol">→</a> <a id="2412" href="Common.Weakening.html#Weakenable" class="Record">Weakenable</a> <a id="2423" class="Symbol">(</a><a id="2424" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="2428" href="MJSF.Values.html#2407" class="Bound">t</a><a id="2429" class="Symbol">)</a>
    <a id="2435" href="MJSF.Values.html#ValuesG.val-weakenable" class="Function">val-weakenable</a> <a id="2450" class="Symbol">=</a> <a id="2452" class="Keyword">record</a> <a id="2459" class="Symbol">{</a> <a id="2461" class="Field">wk</a> <a id="2464" class="Symbol">=</a> <a id="2466" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a> <a id="2477" class="Symbol">}</a>

  <a id="ValuesG.valᵗ-weaken" href="MJSF.Values.html#ValuesG.val%E1%B5%97-weaken" class="Function">valᵗ-weaken</a> <a id="2494" class="Symbol">:</a> <a id="2496" class="Symbol">∀</a> <a id="2498" class="Symbol">{</a><a id="2499" href="MJSF.Values.html#2499" class="Bound">t</a> <a id="2501" href="MJSF.Values.html#2501" class="Bound">Σ</a> <a id="2503" href="MJSF.Values.html#2503" class="Bound">Σ&#39;</a><a id="2505" class="Symbol">}</a> <a id="2507" class="Symbol">→</a> <a id="2509" href="MJSF.Values.html#2501" class="Bound">Σ</a> <a id="2511" href="Data.List.Prefix.html#_%E2%8A%91_" class="Datatype Operator">⊑</a> <a id="2513" href="MJSF.Values.html#2503" class="Bound">Σ&#39;</a> <a id="2516" class="Symbol">→</a> <a id="2518" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="2523" href="MJSF.Values.html#2499" class="Bound">t</a> <a id="2525" href="MJSF.Values.html#2501" class="Bound">Σ</a> <a id="2527" class="Symbol">→</a> <a id="2529" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="2534" href="MJSF.Values.html#2499" class="Bound">t</a> <a id="2536" href="MJSF.Values.html#2503" class="Bound">Σ&#39;</a>
  <a id="2541" href="MJSF.Values.html#ValuesG.val%E1%B5%97-weaken" class="Function">valᵗ-weaken</a> <a id="2553" href="MJSF.Values.html#2553" class="Bound">ext</a> <a id="2557" class="Symbol">(</a><a id="2558" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.v%E1%B5%97" class="InductiveConstructor">vᵗ</a> <a id="2561" href="MJSF.Values.html#2561" class="Bound">v</a><a id="2562" class="Symbol">)</a>    <a id="2567" class="Symbol">=</a>  <a id="2570" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.v%E1%B5%97" class="InductiveConstructor">vᵗ</a> <a id="2573" class="Symbol">(</a><a id="2574" href="MJSF.Values.html#ValuesG.val-weaken" class="Function">val-weaken</a> <a id="2585" href="MJSF.Values.html#2553" class="Bound">ext</a> <a id="2589" href="MJSF.Values.html#2561" class="Bound">v</a><a id="2590" class="Symbol">)</a>
  <a id="2594" href="MJSF.Values.html#ValuesG.val%E1%B5%97-weaken" class="Function">valᵗ-weaken</a> <a id="2606" href="MJSF.Values.html#2606" class="Bound">ext</a> <a id="2610" class="Symbol">(</a><a id="2611" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.m%E1%B5%97" class="InductiveConstructor">mᵗ</a> <a id="2614" href="MJSF.Values.html#2614" class="Bound">f</a> <a id="2616" href="MJSF.Values.html#2616" class="Bound">m</a><a id="2617" class="Symbol">)</a>    <a id="2622" class="Symbol">=</a>  <a id="2625" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.m%E1%B5%97" class="InductiveConstructor">mᵗ</a> <a id="2628" class="Symbol">(</a><a id="2629" href="Common.Weakening.html#228" class="Field">wk</a> <a id="2632" href="MJSF.Values.html#2606" class="Bound">ext</a> <a id="2636" href="MJSF.Values.html#2614" class="Bound">f</a><a id="2637" class="Symbol">)</a> <a id="2639" href="MJSF.Values.html#2616" class="Bound">m</a>
  <a id="2643" href="MJSF.Values.html#ValuesG.val%E1%B5%97-weaken" class="Function">valᵗ-weaken</a> <a id="2655" href="MJSF.Values.html#2655" class="Bound">ext</a> <a id="2659" class="Symbol">(</a><a id="2660" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.c%E1%B5%97" class="InductiveConstructor">cᵗ</a> <a id="2663" href="MJSF.Values.html#2663" class="Bound">c</a> <a id="2665" href="MJSF.Values.html#2665" class="Bound">ic</a> <a id="2668" href="MJSF.Values.html#2668" class="Bound">f</a><a id="2669" class="Symbol">)</a>  <a id="2672" class="Symbol">=</a>  <a id="2675" href="MJSF.Values.html#ValuesG.Val%E1%B5%97.c%E1%B5%97" class="InductiveConstructor">cᵗ</a> <a id="2678" href="MJSF.Values.html#2663" class="Bound">c</a> <a id="2680" href="MJSF.Values.html#2665" class="Bound">ic</a> <a id="2683" class="Symbol">(</a><a id="2684" href="Common.Weakening.html#228" class="Field">wk</a> <a id="2687" href="MJSF.Values.html#2655" class="Bound">ext</a> <a id="2691" href="MJSF.Values.html#2668" class="Bound">f</a><a id="2692" class="Symbol">)</a>

  <a id="2697" class="Comment">-- And pass these to the scope graph definition:</a>

  <a id="2749" class="Keyword">open</a> <a id="2754" href="ScopeGraph.ScopesFrames.html#UsesVal" class="Module">UsesVal</a> <a id="2762" href="MJSF.Values.html#ValuesG.Val%E1%B5%97" class="Datatype">Valᵗ</a> <a id="2767" href="MJSF.Values.html#ValuesG.val%E1%B5%97-weaken" class="Function">valᵗ-weaken</a> <a id="2779" class="Keyword">renaming</a> <a id="2788" class="Symbol">(</a>getFrame <a id="2798" class="Symbol">to</a> getFrame&#39;<a id="2810" class="Symbol">)</a>

  
  <a id="2818" class="Comment">--------------</a>
  <a id="2835" class="Comment">-- COERCION --</a>
  <a id="2852" class="Comment">--------------</a>

  <a id="2870" class="Comment">-- Our definition of sub-typing gives rise to a notion of sub-type</a>
  <a id="2939" class="Comment">-- coercion, defined below.  Coercions essentially traverse the</a>
  <a id="3005" class="Comment">-- inheritance links of the frame hierarchy for an object instance,</a>
  <a id="3075" class="Comment">-- as described in the paper.</a>

  <a id="ValuesG.coerce&lt;:" href="MJSF.Values.html#ValuesG.coerce%3C%3A" class="Function">coerce&lt;:</a> <a id="3117" class="Symbol">:</a> <a id="3119" class="Symbol">∀</a> <a id="3121" class="Symbol">{</a><a id="3122" href="MJSF.Values.html#3122" class="Bound">t</a> <a id="3124" href="MJSF.Values.html#3124" class="Bound">t&#39;</a> <a id="3127" href="MJSF.Values.html#3127" class="Bound">Σ</a><a id="3128" class="Symbol">}</a> <a id="3130" class="Symbol">→</a> <a id="3132" href="MJSF.Values.html#3122" class="Bound">t</a> <a id="3134" href="MJSF.Syntax.html#2593" class="Datatype Operator">&lt;:</a> <a id="3137" href="MJSF.Values.html#3124" class="Bound">t&#39;</a> <a id="3140" class="Symbol">→</a> <a id="3142" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="3146" href="MJSF.Values.html#3122" class="Bound">t</a> <a id="3148" href="MJSF.Values.html#3127" class="Bound">Σ</a> <a id="3150" class="Symbol">→</a> <a id="3152" href="ScopeGraph.ScopesFrames.html#4055" class="Function">Heap</a> <a id="3157" href="MJSF.Values.html#3127" class="Bound">Σ</a> <a id="3159" class="Symbol">→</a> <a id="3161" href="MJSF.Values.html#ValuesG.Val" class="Datatype">Val</a> <a id="3165" href="MJSF.Values.html#3124" class="Bound">t&#39;</a> <a id="3168" href="MJSF.Values.html#3127" class="Bound">Σ</a>
  <a id="3172" href="MJSF.Values.html#ValuesG.coerce%3C%3A" class="Function">coerce&lt;:</a> <a id="3181" href="MJSF.Syntax.html#2626" class="InductiveConstructor">refl</a> <a id="3186" href="MJSF.Values.html#3186" class="Bound">v</a> <a id="3188" href="MJSF.Values.html#3188" class="Bound">h</a> <a id="3190" class="Symbol">=</a> <a id="3192" href="MJSF.Values.html#3186" class="Bound">v</a>
  <a id="3196" href="MJSF.Values.html#ValuesG.coerce%3C%3A" class="Function">coerce&lt;:</a> <a id="3205" class="Symbol">(</a><a id="3206" href="MJSF.Syntax.html#2655" class="InductiveConstructor">super</a> <a id="3212" href="MJSF.Values.html#3212" class="Bound">edge</a> <a id="3217" href="MJSF.Values.html#3217" class="Bound">σ</a><a id="3218" class="Symbol">)</a> <a id="3220" href="MJSF.Values.html#ValuesG.Val.null" class="InductiveConstructor">null</a> <a id="3225" href="MJSF.Values.html#3225" class="Bound">h</a> <a id="3227" class="Symbol">=</a> <a id="3229" href="MJSF.Values.html#ValuesG.coerce%3C%3A" class="Function">coerce&lt;:</a> <a id="3238" href="MJSF.Values.html#3217" class="Bound">σ</a> <a id="3240" href="MJSF.Values.html#ValuesG.Val.null" class="InductiveConstructor">null</a> <a id="3245" href="MJSF.Values.html#3225" class="Bound">h</a>
  <a id="3249" href="MJSF.Values.html#ValuesG.coerce%3C%3A" class="Function">coerce&lt;:</a> <a id="3258" class="Symbol">(</a><a id="3259" href="MJSF.Syntax.html#2655" class="InductiveConstructor">super</a> <a id="3265" href="MJSF.Values.html#3265" class="Bound">edge</a> <a id="3270" href="MJSF.Values.html#3270" class="Bound">σ</a><a id="3271" class="Symbol">)</a> <a id="3273" class="Symbol">(</a><a id="3274" href="MJSF.Values.html#ValuesG.Val.ref" class="InductiveConstructor">ref</a> <a id="3278" href="MJSF.Values.html#3278" class="Bound">f</a><a id="3279" class="Symbol">)</a> <a id="3281" href="MJSF.Values.html#3281" class="Bound">h</a>
    <a id="3287" class="Keyword">with</a> <a id="3292" class="Symbol">(</a><a id="3293" href="Data.List.All.html#lookup" class="Function">lookup</a> <a id="3300" href="MJSF.Values.html#3281" class="Bound">h</a> <a id="3302" href="MJSF.Values.html#3278" class="Bound">f</a><a id="3303" class="Symbol">)</a>
  <a id="3307" class="Symbol">...</a>  <a id="3312" class="Symbol">|</a> <a id="3314" class="Symbol">(_</a> <a id="3317" href="Data.Product.html#%CE%A3._%2C_" class="InductiveConstructor Operator">,</a> <a id="3319" href="MJSF.Values.html#3319" class="Bound">links</a><a id="3324" class="Symbol">)</a>  <a id="3327" class="Symbol">=</a>  <a id="3330" href="MJSF.Values.html#ValuesG.coerce%3C%3A" class="Function">coerce&lt;:</a> <a id="3339" class="Bound">σ</a> <a id="3341" class="Symbol">(</a><a id="3342" href="MJSF.Values.html#ValuesG.Val.ref" class="InductiveConstructor">ref</a> <a id="3346" class="Symbol">(</a><a id="3347" href="Data.List.All.html#lookup" class="Function">lookup</a> <a id="3354" href="MJSF.Values.html#3319" class="Bound">links</a> <a id="3360" class="Bound">edge</a><a id="3364" class="Symbol">))</a> <a id="3367" class="Bound">h</a>

</pre></body></html>